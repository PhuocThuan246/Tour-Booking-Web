2025-05-13 11:15:15.2092 INFO Executed DbCommand (53ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 11:15:15.2957 INFO Executed DbCommand (6ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 11:15:15.6444 INFO Now listening on: http://localhost:5062 
2025-05-13 11:15:15.7044 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 11:15:15.7044 INFO Hosting environment: Development 
2025-05-13 11:15:15.7044 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 11:18:57.1180 INFO Executed DbCommand (14ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:18:57.2050 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 11:18:57.3015 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 11:18:57.3236 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 11:18:57.6343 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:18:57.6927 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 11:18:59.0562 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 11:18:59.0736 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 11:19:02.9703 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:19:02.9703 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 11:19:02.9946 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:20:25.6654 INFO Executed DbCommand (11ms) [Parameters=[@__TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__TourId_0 
2025-05-13 11:20:25.6902 INFO Executed DbCommand (9ms) [Parameters=[@__TourId_0='?' (DbType = Int32), @__DepartureDate_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__TourId_0 AND CONVERT(date, [t].[DepartureDate]) = @__DepartureDate_Date_1 
2025-05-13 11:20:25.6902 WARN Không đủ chỗ: Đặt 1000, còn lại 25 – TourID = 36 
2025-05-13 11:20:25.7138 INFO Executed DbCommand (6ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:20:25.7138 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 11:20:25.7187 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:43:12.6042 INFO Executed DbCommand (34ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 11:43:12.6887 INFO Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 11:43:12.8646 INFO Now listening on: http://localhost:5062 
2025-05-13 11:43:12.9028 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 11:43:12.9028 INFO Hosting environment: Development 
2025-05-13 11:43:12.9028 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 11:43:46.6294 INFO Executed DbCommand (14ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:43:46.6986 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 11:43:46.7800 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 11:43:46.7990 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 11:43:47.1005 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:43:47.1598 INFO Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 11:44:00.4300 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 11:44:00.4496 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 11:44:03.4951 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:44:03.4986 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 11:44:03.5193 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:44:23.8721 INFO Executed DbCommand (2ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__model_TourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:44:23.8721 INFO Executed DbCommand (2ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:44:27.1993 INFO Executed DbCommand (1ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:44:27.2002 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 11:44:27.2002 INFO Executed DbCommand (1ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:45:46.8780 INFO Executed DbCommand (33ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 11:45:46.9537 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 11:45:47.0962 INFO Now listening on: http://localhost:5062 
2025-05-13 11:45:47.1374 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 11:45:47.1374 INFO Hosting environment: Development 
2025-05-13 11:45:47.1374 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 11:45:47.7715 INFO Executed DbCommand (7ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:45:47.8169 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 11:45:47.8536 INFO Executed DbCommand (4ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:46:33.0397 INFO Executed DbCommand (35ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 11:46:33.1184 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 11:46:33.2492 INFO Now listening on: http://localhost:5062 
2025-05-13 11:46:33.2900 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 11:46:33.2900 INFO Hosting environment: Development 
2025-05-13 11:46:33.2900 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 11:46:35.1726 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:46:35.2346 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 11:46:35.3095 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 11:46:35.3281 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 11:46:35.6077 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:46:35.6539 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 11:46:37.0682 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 11:46:37.0853 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 11:46:39.4656 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:46:39.4656 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 11:46:39.4930 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:46:42.7615 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 11:46:42.7644 INFO Executed DbCommand (0ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 11:49:39.5696 INFO Executed DbCommand (33ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 11:49:39.6508 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 11:49:39.7923 INFO Now listening on: http://localhost:5062 
2025-05-13 11:49:39.8307 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 11:49:39.8307 INFO Hosting environment: Development 
2025-05-13 11:49:39.8307 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 11:49:40.4876 INFO Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 11:49:40.5599 INFO Executed DbCommand (5ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 11:49:59.1650 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 11:49:59.1698 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 11:50:00.7653 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:50:00.7653 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 11:50:00.8053 INFO Executed DbCommand (4ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:50:08.1614 INFO Executed DbCommand (32ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 11:50:08.2339 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 11:50:08.3633 INFO Now listening on: http://localhost:5062 
2025-05-13 11:50:08.4017 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 11:50:08.4017 INFO Hosting environment: Development 
2025-05-13 11:50:08.4017 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 11:50:10.3831 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:50:10.4486 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 11:50:10.5310 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 11:50:10.5521 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 11:50:10.8425 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:50:10.8994 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 11:50:12.5656 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 11:50:12.5821 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 11:50:15.5741 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:50:15.5780 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 11:50:15.5949 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:50:23.3555 INFO Executed DbCommand (14ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 11:50:23.3606 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 11:50:53.4246 INFO Executed DbCommand (32ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 11:50:53.4990 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 11:50:53.6315 INFO Now listening on: http://localhost:5062 
2025-05-13 11:50:53.6706 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 11:50:53.6706 INFO Hosting environment: Development 
2025-05-13 11:50:53.6706 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 11:51:04.5384 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:51:04.5991 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 11:51:04.6704 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 11:51:04.6886 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 11:51:04.9804 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:51:05.0335 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 11:51:07.1048 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 11:51:07.1216 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 11:51:10.5713 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:51:10.5713 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 11:51:10.5913 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:51:10.5913 ERROR An unhandled exception has occurred while executing the request. System.InvalidOperationException: The model item passed into the ViewDataDictionary is of type 'TourBookingWeb.Models.Booking', but this ViewDataDictionary instance requires a model item of type 'TourBookingWeb.Models.ViewModels.BookingViewModel'.
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewDataDictionary.EnsureCompatible(Object value)
   at lambda_method578(Closure, ViewDataDictionary)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPagePropertyActivator.Activate(Object page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 11:51:12.8766 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 11:51:12.8766 INFO Executed DbCommand (0ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 11:51:37.3950 INFO Executed DbCommand (13ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:51:37.3950 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 11:51:37.3950 INFO Executed DbCommand (4ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:51:37.3950 ERROR An unhandled exception has occurred while executing the request. System.InvalidOperationException: The model item passed into the ViewDataDictionary is of type 'TourBookingWeb.Models.Booking', but this ViewDataDictionary instance requires a model item of type 'TourBookingWeb.Models.ViewModels.BookingViewModel'.
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewDataDictionary.EnsureCompatible(Object value)
   at lambda_method578(Closure, ViewDataDictionary)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPagePropertyActivator.Activate(Object page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 11:51:49.6085 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 11:51:49.6085 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 11:53:09.5374 INFO Executed DbCommand (32ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 11:53:09.6068 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 11:53:09.7369 INFO Now listening on: http://localhost:5062 
2025-05-13 11:53:09.7749 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 11:53:09.7749 INFO Hosting environment: Development 
2025-05-13 11:53:09.7749 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 11:53:12.0025 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:53:12.0626 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 11:53:12.1359 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 11:53:12.1543 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 11:53:12.4342 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:53:12.4792 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 11:53:13.8424 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 11:53:13.8640 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 11:53:17.2285 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:53:17.2323 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 11:53:17.2323 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:57:14.9989 INFO Executed DbCommand (30ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 11:57:15.0661 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 11:57:15.1944 INFO Now listening on: http://localhost:5062 
2025-05-13 11:57:15.2324 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 11:57:15.2324 INFO Hosting environment: Development 
2025-05-13 11:57:15.2324 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 11:57:17.7855 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:57:17.8442 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 11:57:17.9187 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 11:57:17.9370 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 11:57:18.2193 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:57:18.2667 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 11:57:19.4666 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 11:57:19.4833 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 11:57:23.6747 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:57:23.6747 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "01/01/0001" 
2025-05-13 11:57:23.6877 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:57:44.8713 INFO Executed DbCommand (2ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__model_TourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:57:44.8787 INFO Executed DbCommand (2ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:57:52.4195 INFO Executed DbCommand (1ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__model_TourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:57:52.4195 INFO Executed DbCommand (1ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:58:19.8236 INFO Executed DbCommand (4ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:58:19.8236 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "01/01/0001" 
2025-05-13 11:58:19.8272 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:58:45.0686 INFO Executed DbCommand (26ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 11:58:45.1499 INFO Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 11:58:45.2968 INFO Now listening on: http://localhost:5062 
2025-05-13 11:58:45.3425 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 11:58:45.3425 INFO Hosting environment: Development 
2025-05-13 11:58:45.3425 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 11:59:20.5549 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:59:20.6217 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 11:59:20.7188 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 11:59:20.7435 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 11:59:21.0289 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 11:59:21.0801 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 11:59:22.5489 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 11:59:22.5659 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 11:59:25.6769 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:59:25.6769 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 11:59:25.6907 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 11:59:40.3370 INFO Executed DbCommand (2ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__model_TourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 11:59:40.3446 INFO Executed DbCommand (2ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 12:07:27.3637 INFO Executed DbCommand (34ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:07:27.4378 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 12:07:27.5791 INFO Now listening on: http://localhost:5062 
2025-05-13 12:07:27.6284 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 12:07:27.6284 INFO Hosting environment: Development 
2025-05-13 12:07:27.6284 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 12:07:33.5613 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:07:33.6283 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 12:07:33.7076 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 12:07:33.7290 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 12:07:34.0484 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:07:34.1025 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 12:07:35.6499 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 12:07:35.6718 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 12:07:38.8087 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 12:07:38.8122 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 12:07:38.8287 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 12:07:38.8287 ERROR An unhandled exception has occurred while executing the request. System.InvalidOperationException: The model item passed into the ViewDataDictionary is of type 'TourBookingWeb.Models.Booking', but this ViewDataDictionary instance requires a model item of type 'TourBookingWeb.Models.ViewModels.BookingViewModel'.
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewDataDictionary.EnsureCompatible(Object value)
   at lambda_method578(Closure, ViewDataDictionary)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPagePropertyActivator.Activate(Object page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 12:09:30.0715 INFO Executed DbCommand (32ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:09:30.1430 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 12:09:30.2799 INFO Now listening on: http://localhost:5062 
2025-05-13 12:09:30.3176 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 12:09:30.3176 INFO Hosting environment: Development 
2025-05-13 12:09:30.3176 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 12:09:35.0047 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:09:35.0645 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 12:09:35.1378 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 12:09:35.1564 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 12:09:35.4436 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:09:35.4873 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 12:09:37.0260 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 12:09:37.0445 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 12:09:40.3909 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 12:09:40.3909 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 12:09:40.4111 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 12:09:54.9646 INFO Executed DbCommand (2ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 
2025-05-13 12:09:54.9740 INFO Executed DbCommand (3ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32), @__parsedDepartureDate_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 AND CONVERT(date, [t].[DepartureDate]) = @__parsedDepartureDate_Date_1 
2025-05-13 12:09:54.9831 INFO Executed DbCommand (5ms) [Parameters=[@__model_Email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__model_Email_0 
2025-05-13 12:09:55.1198 INFO Executed DbCommand (18ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (Size = 200), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p11='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Bookings] ([AdultQuantity], [BookingDate], [ChildQuantity], [DepartureDate], [PaymentMethod], [SpecialRequest], [TotalPrice], [TourId], [TourScheduleId], [UserId])
OUTPUT INSERTED.[BookingId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [TourSchedules] SET [RemainingSlot] = @p10
OUTPUT 1
WHERE [TourScheduleId] = @p11; 
2025-05-13 12:09:55.1366 INFO Đặt tour thành công – TourID: 36, Tên tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor", Ngày đi: "22/11/2025", Người đặt: "a", Email: "a@gmail.com", Số điện thoại: "2213132897", Địa chỉ: "2", Người lớn: 2, Trẻ em: 0, Tổng tiền: "90.000.000" đ, Thanh toán: "Quầy" 
2025-05-13 12:09:55.1496 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:09:55.1496 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 12:09:55.1550 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 12:09:55.1550 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 12:09:55.3410 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:09:55.3410 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 12:10:09.0063 INFO Executed DbCommand (10ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 12:10:09.0882 INFO Executed DbCommand (11ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 12:10:09.1221 INFO Executed DbCommand (20ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 12:10:09.1221 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:10:09.1440 INFO Executed DbCommand (11ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 12:10:09.1618 INFO Executed DbCommand (9ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 12:10:09.1725 INFO Executed DbCommand (10ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 12:10:09.1725 INFO Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:10:09.1852 INFO Executed DbCommand (7ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 12:10:09.1852 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 12:10:09.2491 INFO Executed DbCommand (16ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 12:10:09.2491 WARN admin 
2025-05-13 12:10:10.5947 INFO Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin' 
2025-05-13 12:10:10.5947 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin'
ORDER BY [u].[UserId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY 
2025-05-13 12:10:11.0921 INFO Executed DbCommand (8ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 12:10:11.1398 INFO Executed DbCommand (26ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 12:10:11.2125 INFO Executed DbCommand (8ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 12:10:11.2355 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 12:13:05.0070 INFO Executed DbCommand (14ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 12:13:05.0129 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u] 
2025-05-13 12:13:05.0129 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t] 
2025-05-13 12:13:05.0129 INFO Executed DbCommand (3ms) [Parameters=[@__booking_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__booking_TourId_0
ORDER BY [t].[DepartureDate] 
2025-05-13 12:13:29.0783 INFO Executed DbCommand (47ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:13:29.1760 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 12:13:29.4462 INFO Now listening on: http://localhost:5062 
2025-05-13 12:13:29.4998 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 12:13:29.4998 INFO Hosting environment: Development 
2025-05-13 12:13:29.4998 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 12:27:41.7205 INFO Executed DbCommand (14ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:27:41.8197 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 12:27:41.9105 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 12:27:41.9368 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 12:27:42.3131 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:27:42.3780 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 12:28:10.8445 INFO Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 12:28:10.8647 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 12:28:14.3799 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 12:28:14.3799 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 12:28:14.4005 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 12:28:16.3245 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 12:28:16.3276 INFO Executed DbCommand (0ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 12:28:18.0655 INFO Executed DbCommand (0ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 12:28:18.0655 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 12:28:18.0655 INFO Executed DbCommand (0ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 12:31:04.0247 INFO Executed DbCommand (33ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:31:04.1054 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 12:31:04.3371 INFO Now listening on: http://localhost:5062 
2025-05-13 12:31:04.3932 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 12:31:04.3932 INFO Hosting environment: Development 
2025-05-13 12:31:04.3932 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 12:31:07.4695 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:31:07.5446 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 12:31:07.6408 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 12:31:07.6701 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 12:31:08.0051 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:31:08.0554 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 12:31:10.5575 INFO Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 12:31:10.5903 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 12:31:13.5249 INFO Executed DbCommand (4ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 12:31:13.5304 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 12:31:13.5532 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 12:32:05.6366 INFO Executed DbCommand (24ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:32:05.7090 INFO Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 12:32:05.8493 INFO Now listening on: http://localhost:5062 
2025-05-13 12:32:05.8892 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 12:32:05.8892 INFO Hosting environment: Development 
2025-05-13 12:32:05.8892 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 12:32:08.7928 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:32:08.8500 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 12:32:08.9351 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 12:32:08.9531 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 12:32:09.2734 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:32:09.3262 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 12:32:10.4895 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 12:32:10.5099 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 12:32:13.5815 INFO Executed DbCommand (0ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 12:32:13.5815 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 12:32:13.6002 INFO Executed DbCommand (1ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 12:34:43.4151 INFO Executed DbCommand (11ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 12:34:43.4151 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 12:34:43.4201 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 12:35:02.8437 INFO Executed DbCommand (33ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:35:02.9242 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 12:35:03.1637 INFO Now listening on: http://localhost:5062 
2025-05-13 12:35:03.2233 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 12:35:03.2233 INFO Hosting environment: Development 
2025-05-13 12:35:03.2233 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 12:35:08.7921 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:35:08.8709 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 12:35:08.9527 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 12:35:08.9773 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 12:35:09.3117 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:35:09.3583 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 12:35:11.0098 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 12:35:11.0640 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 12:35:14.1916 INFO Executed DbCommand (0ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 12:35:14.1916 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 12:35:14.2106 INFO Executed DbCommand (1ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 12:41:08.4528 INFO Executed DbCommand (32ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:41:08.5314 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 12:41:08.6880 INFO Now listening on: http://localhost:5062 
2025-05-13 12:41:08.7271 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 12:41:08.7271 INFO Hosting environment: Development 
2025-05-13 12:41:08.7271 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 12:41:10.5066 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:41:10.5677 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 12:41:10.6428 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 12:41:10.6614 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 12:41:10.9536 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:41:11.0028 INFO Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 12:41:12.0641 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 12:41:12.0798 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 12:41:14.7030 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 12:41:14.7030 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 12:41:16.3146 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 12:41:16.3146 INFO Người dùng mở trang đặt tour: "Tour Đà Lạt 3N2Đ - Thành phố ngàn hoa" – Ngày đi: "10/12/2025" 
2025-05-13 12:41:16.3375 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 12:42:22.7316 INFO Executed DbCommand (36ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:42:22.8187 INFO Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 12:42:22.9657 INFO Now listening on: http://localhost:5062 
2025-05-13 12:42:23.0061 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 12:42:23.0061 INFO Hosting environment: Development 
2025-05-13 12:42:23.0061 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 12:42:23.6750 INFO Executed DbCommand (6ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 12:42:23.7183 INFO Người dùng mở trang đặt tour: "Tour Đà Lạt 3N2Đ - Thành phố ngàn hoa" – Ngày đi: "10/12/2025" 
2025-05-13 12:42:23.7547 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 12:45:33.4349 INFO Executed DbCommand (60ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:45:33.5301 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 12:45:33.8403 INFO Now listening on: http://localhost:5062 
2025-05-13 12:45:33.9077 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 12:45:33.9077 INFO Hosting environment: Development 
2025-05-13 12:45:33.9077 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 12:45:37.0259 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:45:37.1108 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 12:45:37.1965 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 12:45:37.2245 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 12:45:37.5656 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:45:37.6379 INFO Executed DbCommand (14ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 12:45:40.0500 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 12:45:40.0688 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 12:45:42.9035 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 12:45:42.9035 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 12:45:42.9241 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 12:52:59.2560 INFO Executed DbCommand (39ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:52:59.3335 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 12:52:59.5562 INFO Now listening on: http://localhost:5062 
2025-05-13 12:52:59.6052 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 12:52:59.6052 INFO Hosting environment: Development 
2025-05-13 12:52:59.6052 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 12:53:03.9641 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:53:04.0516 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 12:53:04.1566 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 12:53:04.1871 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 12:53:04.5395 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:53:04.6308 INFO Executed DbCommand (20ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 12:53:16.2572 INFO Executed DbCommand (10ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 12:53:16.3508 INFO Executed DbCommand (2ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 12:53:16.3868 INFO Executed DbCommand (15ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 12:53:16.3938 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:53:16.4094 INFO Executed DbCommand (9ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 12:53:16.4234 INFO Executed DbCommand (8ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 12:53:16.4383 INFO Executed DbCommand (13ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 12:53:16.4383 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:53:16.4537 INFO Executed DbCommand (8ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 12:53:16.4537 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 12:53:16.4696 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 12:53:16.4696 WARN admin 
2025-05-13 12:53:19.0713 INFO Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 12:53:19.1007 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 12:53:19.1980 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 12:53:19.2192 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 12:53:20.2746 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 12:53:20.2746 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 12:53:20.3191 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 12:53:20.3191 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 12:53:23.4372 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 12:53:23.4548 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 12:53:25.5211 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:53:25.5211 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 12:53:25.5308 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 12:53:25.5308 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 12:53:29.4394 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 12:53:29.4394 INFO Executed DbCommand (0ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 12:53:33.3614 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 12:53:33.3614 INFO Người dùng mở trang đặt tour: "Tour Cần Giờ 1N – Rừng ngập mặn" – Ngày đi: "05/12/2025" 
2025-05-13 12:53:33.3808 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 12:56:11.6963 INFO Executed DbCommand (43ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 12:56:11.7834 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 12:56:12.0403 INFO Now listening on: http://localhost:5062 
2025-05-13 12:56:12.0971 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 12:56:12.0971 INFO Hosting environment: Development 
2025-05-13 12:56:12.0971 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 12:56:42.8967 INFO Executed DbCommand (12ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:56:42.9887 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 12:56:43.1043 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 12:56:43.1366 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 12:56:43.5293 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 12:56:43.6096 INFO Executed DbCommand (23ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 12:56:44.8157 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 12:56:44.8346 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 12:56:46.9576 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 12:56:46.9576 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 12:56:46.9824 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:00:56.5210 INFO Executed DbCommand (39ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 13:00:56.6001 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:00:56.8306 INFO Now listening on: http://localhost:5062 
2025-05-13 13:00:56.8808 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 13:00:56.8808 INFO Hosting environment: Development 
2025-05-13 13:00:56.8808 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 13:01:10.4912 INFO Executed DbCommand (10ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:01:10.5640 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:01:10.6431 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:01:10.6702 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:01:10.9848 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:01:11.0413 INFO Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:01:12.6242 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:01:12.6441 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:01:15.2745 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 13:01:15.2792 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 13:01:15.2958 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:01:35.4392 INFO Executed DbCommand (0ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 13:01:35.4392 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 13:01:35.4392 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:02:06.4578 INFO Executed DbCommand (16ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 
2025-05-13 13:02:06.4693 INFO Executed DbCommand (4ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32), @__parsedDepartureDate_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 AND CONVERT(date, [t].[DepartureDate]) = @__parsedDepartureDate_Date_1 
2025-05-13 13:02:06.4693 INFO Executed DbCommand (2ms) [Parameters=[@__model_Email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__model_Email_0 
2025-05-13 13:02:06.5667 INFO Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 200), @p1='?' (Size = 200), @p2='?' (Size = 200), @p3='?' (Size = 200), @p4='?' (Size = 200), @p5='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Address], [Email], [FullName], [Password], [Phone], [Role])
OUTPUT INSERTED.[UserId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5); 
2025-05-13 13:02:06.6466 INFO Executed DbCommand (24ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (Size = 200), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p11='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Bookings] ([AdultQuantity], [BookingDate], [ChildQuantity], [DepartureDate], [PaymentMethod], [SpecialRequest], [TotalPrice], [TourId], [TourScheduleId], [UserId])
OUTPUT INSERTED.[BookingId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [TourSchedules] SET [RemainingSlot] = @p10
OUTPUT 1
WHERE [TourScheduleId] = @p11; 
2025-05-13 13:02:06.6578 INFO Đặt tour thành công – TourID: 36, Tên tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor", Ngày đi: "22/11/2025", Người đặt: "a", Email: "hongphuc@gmail.com", Số điện thoại: "0559960019", Địa chỉ: "a", Người lớn: 1, Trẻ em: 0, Tổng tiền: "45.000.000" đ, Thanh toán: "Quầy" 
2025-05-13 13:02:06.6716 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:02:06.6858 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:02:06.6858 INFO Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:02:06.7044 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:02:06.9088 INFO Executed DbCommand (14ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:02:06.9343 INFO Executed DbCommand (23ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:02:19.9514 INFO Executed DbCommand (39ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 13:02:20.0277 INFO Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:02:20.2607 INFO Now listening on: http://localhost:5062 
2025-05-13 13:02:20.3131 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 13:02:20.3131 INFO Hosting environment: Development 
2025-05-13 13:02:20.3131 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 13:02:48.4426 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:02:48.5141 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 13:02:48.7065 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:02:48.7325 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 13:02:54.0843 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:02:54.1149 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:02:54.1374 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:02:54.1521 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:02:54.4304 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:02:54.4917 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:02:55.5831 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:02:55.6003 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:02:58.4926 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 13:02:58.4926 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 13:02:58.5134 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:03:28.4964 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:03:28.5030 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:03:28.5030 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:03:28.5030 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:03:28.7275 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:03:28.7440 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:03:30.6061 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:03:30.6104 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:03:38.3297 INFO Executed DbCommand (2ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 
2025-05-13 13:03:38.3411 INFO Executed DbCommand (3ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32), @__parsedDepartureDate_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 AND CONVERT(date, [t].[DepartureDate]) = @__parsedDepartureDate_Date_1 
2025-05-13 13:03:38.3411 INFO Executed DbCommand (2ms) [Parameters=[@__model_Email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__model_Email_0 
2025-05-13 13:03:38.4772 INFO Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (Size = 200), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p11='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Bookings] ([AdultQuantity], [BookingDate], [ChildQuantity], [DepartureDate], [PaymentMethod], [SpecialRequest], [TotalPrice], [TourId], [TourScheduleId], [UserId])
OUTPUT INSERTED.[BookingId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [TourSchedules] SET [RemainingSlot] = @p10
OUTPUT 1
WHERE [TourScheduleId] = @p11; 
2025-05-13 13:03:38.4968 INFO Đặt tour thành công – TourID: 36, Tên tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor", Ngày đi: "22/11/2025", Người đặt: "Võ Hồng Phúc", Email: "hongphuc19111306@gmail.com", Số điện thoại: "0559960019", Địa chỉ: "TPHCM", Người lớn: 1, Trẻ em: 0, Tổng tiền: "45.000.000" đ, Thanh toán: "Quầy" 
2025-05-13 13:03:38.5086 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:03:38.5086 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:03:38.5138 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:03:38.5138 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:03:38.7105 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:03:38.7105 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:03:41.2693 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:03:41.2693 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 13:03:41.3193 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:03:41.3278 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 13:03:52.8742 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:03:52.8742 INFO Executed DbCommand (0ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:03:59.2227 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 13:03:59.2227 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u] 
2025-05-13 13:03:59.2376 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t] 
2025-05-13 13:03:59.2376 INFO Executed DbCommand (2ms) [Parameters=[@__booking_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__booking_TourId_0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:06:23.2977 INFO Executed DbCommand (38ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 13:06:23.3767 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:06:23.6015 INFO Now listening on: http://localhost:5062 
2025-05-13 13:06:23.6549 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 13:06:23.6549 INFO Hosting environment: Development 
2025-05-13 13:06:23.6549 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 13:06:41.7306 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:06:41.8069 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:06:41.8954 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:06:41.9240 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:06:42.2415 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:06:42.2983 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:06:43.5807 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:06:43.6000 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:06:54.6226 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 13:06:54.6226 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 13:06:54.6435 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:11:51.1298 INFO Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:11:51.1608 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 13:11:51.2566 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:11:51.2740 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 13:11:54.2434 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 13:11:54.2496 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u] 
2025-05-13 13:11:54.2496 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t] 
2025-05-13 13:11:54.2641 INFO Executed DbCommand (2ms) [Parameters=[@__booking_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__booking_TourId_0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:12:00.2019 INFO Executed DbCommand (13ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:12:00.2019 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:12:22.6730 INFO Executed DbCommand (12ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
LEFT JOIN [TourSchedules] AS [t] ON [b].[TourScheduleId] = [t].[TourScheduleId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 13:12:22.6730 INFO Executed DbCommand (1ms) [Parameters=[@__existing_TourScheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__existing_TourScheduleId_0 
2025-05-13 13:12:22.6730 INFO Executed DbCommand (1ms) [Parameters=[@__booking_TourScheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__booking_TourScheduleId_0 
2025-05-13 13:12:22.6899 INFO Executed DbCommand (2ms) [Parameters=[@__existing_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__existing_TourId_0 
2025-05-13 13:12:22.7826 INFO Executed DbCommand (11ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 200), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p6='?' (DbType = Int32), @p9='?' (DbType = Int32), @p8='?' (DbType = Int32), @p11='?' (DbType = Int32), @p10='?' (DbType = Int32), @p14='?' (DbType = Int32), @p12='?' (Size = 200), @p13='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Bookings] SET [AdultQuantity] = @p0, [BookingDate] = @p1, [DepartureDate] = @p2, [PaymentMethod] = @p3, [SpecialRequest] = @p4, [TotalPrice] = @p5, [TourScheduleId] = @p6
OUTPUT 1
WHERE [BookingId] = @p7;
UPDATE [TourSchedules] SET [RemainingSlot] = @p8
OUTPUT 1
WHERE [TourScheduleId] = @p9;
UPDATE [TourSchedules] SET [RemainingSlot] = @p10
OUTPUT 1
WHERE [TourScheduleId] = @p11;
UPDATE [Users] SET [Email] = @p12, [FullName] = @p13
OUTPUT 1
WHERE [UserId] = @p14; 
2025-05-13 13:12:22.7826 INFO Admin đã chỉnh sửa booking #26 – Người đặt: Võ Hồng Phúc sửa 
2025-05-13 13:12:22.8034 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:12:22.8034 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 13:12:22.8544 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:12:22.8598 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 13:12:32.4148 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:12:32.4206 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:12:55.1091 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:12:55.1091 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:12:55.1091 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:12:55.1091 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:13:12.1146 INFO Executed DbCommand (13ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:13:12.1146 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:13:16.1947 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 13:13:16.1947 INFO Người dùng mở trang đặt tour: "Tour Đà Lạt 3N2Đ - Thành phố ngàn hoa" – Ngày đi: "10/12/2025" 
2025-05-13 13:13:16.1947 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:13:52.3586 INFO Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:13:52.3586 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:14:19.2008 INFO Executed DbCommand (12ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 13:14:19.2008 INFO Người dùng mở trang đặt tour: "Tour Trung Quốc 5N4Đ – Bắc Kinh – Vạn Lý Trường Thành" – Ngày đi: "15/12/2025" 
2025-05-13 13:14:19.2008 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:14:45.5661 INFO Executed DbCommand (1ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 
2025-05-13 13:14:45.5784 INFO Executed DbCommand (2ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32), @__parsedDepartureDate_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 AND CONVERT(date, [t].[DepartureDate]) = @__parsedDepartureDate_Date_1 
2025-05-13 13:14:45.5784 INFO Executed DbCommand (2ms) [Parameters=[@__model_Email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__model_Email_0 
2025-05-13 13:14:45.6046 INFO Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 200), @p1='?' (Size = 200), @p2='?' (Size = 200), @p3='?' (Size = 200), @p4='?' (Size = 200), @p5='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Address], [Email], [FullName], [Password], [Phone], [Role])
OUTPUT INSERTED.[UserId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5); 
2025-05-13 13:14:45.6212 INFO Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (Size = 200), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p11='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Bookings] ([AdultQuantity], [BookingDate], [ChildQuantity], [DepartureDate], [PaymentMethod], [SpecialRequest], [TotalPrice], [TourId], [TourScheduleId], [UserId])
OUTPUT INSERTED.[BookingId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [TourSchedules] SET [RemainingSlot] = @p10
OUTPUT 1
WHERE [TourScheduleId] = @p11; 
2025-05-13 13:14:45.6232 INFO Đặt tour thành công – TourID: 29, Tên tour: "Tour Trung Quốc 5N4Đ – Bắc Kinh – Vạn Lý Trường Thành", Ngày đi: "15/12/2025", Người đặt: "Hồ Ngân", Email: "hongan@gmail.com", Số điện thoại: "0777093325", Địa chỉ: "Nhà bè", Người lớn: 1, Trẻ em: 0, Tổng tiền: "15.500.000" đ, Thanh toán: "Quầy" 
2025-05-13 13:14:45.6232 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:14:45.6232 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:14:45.6408 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:14:45.6408 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:14:45.8325 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:14:45.8429 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:14:47.8721 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:14:47.8770 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 13:14:47.9231 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:14:47.9231 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 13:14:59.7034 INFO Executed DbCommand (5ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 13:14:59.7198 INFO Executed DbCommand (7ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:15:00.0932 INFO Executed DbCommand (1ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 13:15:00.0932 INFO Executed DbCommand (1ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:15:01.0958 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:15:01.0958 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:15:09.2946 INFO Executed DbCommand (0ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 13:15:09.2946 INFO Người dùng mở trang đặt tour: "Tour Trung Quốc 5N4Đ – Bắc Kinh – Vạn Lý Trường Thành" – Ngày đi: "15/12/2025" 
2025-05-13 13:15:09.2946 INFO Executed DbCommand (0ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:15:30.5633 INFO Executed DbCommand (9ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 
2025-05-13 13:15:30.5633 INFO Executed DbCommand (4ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32), @__parsedDepartureDate_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 AND CONVERT(date, [t].[DepartureDate]) = @__parsedDepartureDate_Date_1 
2025-05-13 13:15:30.5633 INFO Executed DbCommand (1ms) [Parameters=[@__model_Email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__model_Email_0 
2025-05-13 13:15:30.5633 INFO Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 200), @p1='?' (Size = 200), @p2='?' (Size = 200), @p3='?' (Size = 200), @p4='?' (Size = 200), @p5='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Address], [Email], [FullName], [Password], [Phone], [Role])
OUTPUT INSERTED.[UserId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5); 
2025-05-13 13:15:30.5798 INFO Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (Size = 200), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p11='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Bookings] ([AdultQuantity], [BookingDate], [ChildQuantity], [DepartureDate], [PaymentMethod], [SpecialRequest], [TotalPrice], [TourId], [TourScheduleId], [UserId])
OUTPUT INSERTED.[BookingId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [TourSchedules] SET [RemainingSlot] = @p10
OUTPUT 1
WHERE [TourScheduleId] = @p11; 
2025-05-13 13:15:30.5798 INFO Đặt tour thành công – TourID: 29, Tên tour: "Tour Trung Quốc 5N4Đ – Bắc Kinh – Vạn Lý Trường Thành", Ngày đi: "15/12/2025", Người đặt: "Hồ Ngân Béo", Email: "HoNganBeo@gmail.com", Số điện thoại: "0777093325", Địa chỉ: "Nhà BÈ", Người lớn: 2, Trẻ em: 0, Tổng tiền: "31.000.000" đ, Thanh toán: "Quầy" 
2025-05-13 13:15:30.5798 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:15:30.5918 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:15:30.5918 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:15:30.5918 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:15:30.7749 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:15:30.7868 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:15:33.6341 INFO Executed DbCommand (2ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 13:15:33.6412 INFO Executed DbCommand (6ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:15:34.9321 INFO Executed DbCommand (1ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 13:15:34.9321 INFO Executed DbCommand (1ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:15:36.5467 INFO Executed DbCommand (2ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 13:15:36.5467 INFO Executed DbCommand (1ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:15:36.9592 INFO Executed DbCommand (1ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 13:15:36.9592 INFO Executed DbCommand (1ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:15:38.1461 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:15:38.1461 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:15:43.2411 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:15:43.2468 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 13:15:43.2855 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:15:43.2855 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 13:15:46.2465 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 13:15:46.2481 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u] 
2025-05-13 13:15:46.2481 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t] 
2025-05-13 13:15:46.2481 INFO Executed DbCommand (1ms) [Parameters=[@__booking_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__booking_TourId_0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:15:53.4865 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
LEFT JOIN [TourSchedules] AS [t] ON [b].[TourScheduleId] = [t].[TourScheduleId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 13:15:53.4865 INFO Executed DbCommand (1ms) [Parameters=[@__existing_TourScheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__existing_TourScheduleId_0 
2025-05-13 13:15:53.4865 INFO Executed DbCommand (1ms) [Parameters=[@__booking_TourScheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__booking_TourScheduleId_0 
2025-05-13 13:15:53.4865 INFO Executed DbCommand (1ms) [Parameters=[@__existing_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__existing_TourId_0 
2025-05-13 13:15:53.4971 INFO Executed DbCommand (4ms) [Parameters=[@p5='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32), @p7='?' (DbType = Int32), @p6='?' (DbType = Int32), @p9='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Bookings] SET [AdultQuantity] = @p0, [BookingDate] = @p1, [DepartureDate] = @p2, [TotalPrice] = @p3, [TourScheduleId] = @p4
OUTPUT 1
WHERE [BookingId] = @p5;
UPDATE [TourSchedules] SET [RemainingSlot] = @p6
OUTPUT 1
WHERE [TourScheduleId] = @p7;
UPDATE [TourSchedules] SET [RemainingSlot] = @p8
OUTPUT 1
WHERE [TourScheduleId] = @p9; 
2025-05-13 13:15:53.4971 INFO Admin đã chỉnh sửa booking #28 – Người đặt: Hồ Ngân Béo 
2025-05-13 13:15:53.4971 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:15:53.4971 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 13:15:53.5451 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:15:53.5451 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 13:15:56.1455 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:15:56.1455 INFO Executed DbCommand (0ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:15:57.7839 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 13:15:57.7839 INFO Người dùng mở trang đặt tour: "Tour Trung Quốc 5N4Đ – Bắc Kinh – Vạn Lý Trường Thành" – Ngày đi: "14/01/2026" 
2025-05-13 13:15:57.7839 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:16:40.6536 INFO Executed DbCommand (9ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 
2025-05-13 13:16:40.6536 INFO Executed DbCommand (4ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32), @__parsedDepartureDate_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 AND CONVERT(date, [t].[DepartureDate]) = @__parsedDepartureDate_Date_1 
2025-05-13 13:16:40.6536 WARN Không đủ chỗ: Đặt 20, còn lại 18 – TourID = 29 
2025-05-13 13:16:40.6536 INFO Executed DbCommand (4ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 13:16:40.6536 INFO Người dùng mở trang đặt tour: "Tour Trung Quốc 5N4Đ – Bắc Kinh – Vạn Lý Trường Thành" – Ngày đi: "14/01/2026" 
2025-05-13 13:16:40.6709 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:16:55.2935 INFO Executed DbCommand (35ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 13:16:55.3767 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:16:55.6108 INFO Now listening on: http://localhost:5062 
2025-05-13 13:16:55.6593 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 13:16:55.6593 INFO Hosting environment: Development 
2025-05-13 13:16:55.6593 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 13:16:58.4572 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:16:58.5343 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:16:58.6149 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:16:58.6418 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:16:58.9513 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:16:59.0027 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:17:01.5139 INFO Executed DbCommand (3ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 13:17:01.5416 INFO Executed DbCommand (14ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:17:02.3318 INFO Executed DbCommand (1ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 13:17:02.3318 INFO Executed DbCommand (1ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:17:02.7310 INFO Executed DbCommand (1ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 13:17:02.7339 INFO Executed DbCommand (1ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:17:04.8100 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:17:04.8285 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:18:28.2746 INFO Executed DbCommand (8ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:19:16.8653 INFO Executed DbCommand (10ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:19:16.8653 INFO Executed DbCommand (2ms) [Parameters=[@__model_Email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__model_Email_0 
2025-05-13 13:19:16.9559 INFO Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0 
2025-05-13 13:19:17.0644 INFO Executed DbCommand (9ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 256), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 256), @p8='?' (Size = 256), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (Size = 256), @p15='?' (Size = 200), @p16='?' (Size = 200), @p17='?' (Size = 200), @p18='?' (Size = 200), @p19='?' (Size = 200), @p20='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUsers] ([Id], [AccessFailedCount], [ConcurrencyStamp], [Email], [EmailConfirmed], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [SecurityStamp], [TwoFactorEnabled], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
INSERT INTO [Users] ([Address], [Email], [FullName], [Password], [Phone], [Role])
OUTPUT INSERTED.[UserId]
VALUES (@p15, @p16, @p17, @p18, @p19, @p20); 
2025-05-13 13:19:21.0380 INFO Đăng ký thành công cho kieungan230604@gmail.com, đã gửi mã OTP 
2025-05-13 13:19:59.7748 INFO Executed DbCommand (9ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:19:59.7792 INFO Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0 
2025-05-13 13:19:59.7993 INFO Executed DbCommand (11ms) [Parameters=[@p14='?' (Size = 450), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p15='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 256), @p7='?' (Size = 256), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (DbType = Boolean), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [Email] = @p2, [EmailConfirmed] = @p3, [LockoutEnabled] = @p4, [LockoutEnd] = @p5, [NormalizedEmail] = @p6, [NormalizedUserName] = @p7, [PasswordHash] = @p8, [PhoneNumber] = @p9, [PhoneNumberConfirmed] = @p10, [SecurityStamp] = @p11, [TwoFactorEnabled] = @p12, [UserName] = @p13
OUTPUT 1
WHERE [Id] = @p14 AND [ConcurrencyStamp] = @p15; 
2025-05-13 13:20:33.0100 INFO Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:20:33.0905 INFO Executed DbCommand (2ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 13:20:33.1075 INFO Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:20:33.1075 INFO Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 13:20:33.1075 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:20:33.1075 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:20:33.1285 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:20:33.1285 WARN  
2025-05-13 13:20:37.7780 INFO Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:20:46.2488 INFO Executed DbCommand (8ms) [Parameters=[@__model_Email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__model_Email_0 
2025-05-13 13:20:46.2488 INFO Người dùng cập nhật hồ sơ thành công: kieungan230604@gmail.com 
2025-05-13 13:20:46.2488 INFO Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:22:04.6403 INFO Executed DbCommand (41ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 13:22:04.7299 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:22:05.0208 INFO Now listening on: http://localhost:5062 
2025-05-13 13:22:05.0736 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 13:22:05.0736 INFO Hosting environment: Development 
2025-05-13 13:22:05.0736 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 13:22:09.6369 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:22:09.7321 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:22:09.8254 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:22:09.8561 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:22:10.1851 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:22:10.2775 INFO Executed DbCommand (22ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:22:13.8534 INFO Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:22:17.0361 INFO Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:22:17.0675 INFO Executed DbCommand (5ms) [Parameters=[@__user_UserId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b].[TourScheduleId] = [t0].[TourScheduleId]
LEFT JOIN [Images] AS [i] ON [t].[TourId] = [i].[TourId]
WHERE [b].[UserId] = @__user_UserId_0
ORDER BY [b].[BookingDate] DESC, [b].[BookingId], [t].[TourId], [t0].[TourScheduleId] 
2025-05-13 13:22:19.6541 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:22:19.6541 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:22:19.6541 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:22:19.6541 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:22:19.8437 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:22:19.8437 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:24:00.1805 INFO Executed DbCommand (12ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:24:00.1952 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:24:08.7967 INFO Executed DbCommand (12ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 13:24:08.7967 INFO Người dùng mở trang đặt tour: "Tour Đà Lạt 3N2Đ - Thành phố ngàn hoa" – Ngày đi: "10/12/2025" 
2025-05-13 13:24:08.8196 INFO Executed DbCommand (4ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:26:38.1972 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:26:38.2038 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:26:38.2038 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:26:38.2038 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:26:38.4721 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:26:38.5057 INFO Executed DbCommand (31ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:26:39.7551 INFO Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:26:41.0544 INFO Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:26:41.0625 INFO Executed DbCommand (6ms) [Parameters=[@__user_UserId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b].[TourScheduleId] = [t0].[TourScheduleId]
LEFT JOIN [Images] AS [i] ON [t].[TourId] = [i].[TourId]
WHERE [b].[UserId] = @__user_UserId_0
ORDER BY [b].[BookingDate] DESC, [b].[BookingId], [t].[TourId], [t0].[TourScheduleId] 
2025-05-13 13:26:49.0782 INFO Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:26:51.5187 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:26:51.5187 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:26:51.5187 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:26:51.5187 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:26:51.6983 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:26:51.7020 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:26:54.0066 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:26:54.0066 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:26:54.9785 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:26:54.9785 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:26:54.9828 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:26:54.9828 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:26:56.3374 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:26:56.3374 INFO Executed DbCommand (0ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:27:06.6221 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 13:27:06.6221 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 13:27:06.6221 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:29:05.4743 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:29:05.4810 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:29:05.4810 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:29:05.4810 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:29:05.6752 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:29:05.6899 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:29:17.9936 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:29:17.9936 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:29:17.9982 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:29:17.9982 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:29:18.2081 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:29:18.2081 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:29:19.8182 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:29:19.8182 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:31:16.2714 INFO Executed DbCommand (39ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 13:31:16.3459 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:31:16.5850 INFO Now listening on: http://localhost:5062 
2025-05-13 13:31:16.6365 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 13:31:16.6365 INFO Hosting environment: Development 
2025-05-13 13:31:16.6365 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 13:31:18.8181 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:31:18.9013 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:31:19.0100 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:31:19.0407 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:31:19.3737 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:31:19.4292 INFO Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:31:21.1439 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:31:21.1689 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:31:25.1979 INFO Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:31:25.2012 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:31:35.4824 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:31:35.4824 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:31:35.4824 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:31:35.4824 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:31:35.6721 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:31:35.6721 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:31:36.8972 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:31:36.8972 INFO Executed DbCommand (0ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:31:38.7427 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 13:31:38.7427 INFO Người dùng mở trang đặt tour: "Tour Ba Vì – Làng Văn hóa 1N" – Ngày đi: "12/10/2025" 
2025-05-13 13:31:38.7646 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:31:43.4980 INFO Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:31:43.4980 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:31:43.5258 INFO Executed DbCommand (12ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:31:43.5304 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:31:43.7301 INFO Executed DbCommand (12ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:31:43.7650 INFO Executed DbCommand (33ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:33:03.7181 INFO Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 13:33:03.8009 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:33:04.1249 INFO Now listening on: http://localhost:5062 
2025-05-13 13:33:04.1769 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 13:33:04.1769 INFO Hosting environment: Development 
2025-05-13 13:33:04.1769 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 13:33:06.9208 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:33:07.0054 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:33:07.1014 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:33:07.1275 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:33:07.4284 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:33:07.4868 INFO Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:33:08.5348 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:33:08.5544 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:33:24.2914 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:33:24.2914 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:33:24.2997 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:33:24.2997 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:33:24.4878 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:33:24.5013 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:33:26.1375 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:33:26.1423 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:34:21.3216 INFO Executed DbCommand (38ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 13:34:21.3957 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:34:21.6274 INFO Now listening on: http://localhost:5062 
2025-05-13 13:34:21.6872 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 13:34:21.6872 INFO Hosting environment: Development 
2025-05-13 13:34:21.6872 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 13:34:24.3147 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:34:24.3866 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:34:24.4861 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:34:24.5085 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:34:24.7934 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:34:24.8486 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:34:26.0082 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:34:26.0293 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:34:37.4808 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:34:37.4832 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:34:37.4832 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:34:37.4832 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:34:37.6688 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:34:37.6742 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:35:24.5175 INFO Executed DbCommand (44ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 13:35:24.5940 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:35:24.8316 INFO Now listening on: http://localhost:5062 
2025-05-13 13:35:24.8843 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 13:35:24.8843 INFO Hosting environment: Development 
2025-05-13 13:35:24.8843 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 13:41:21.3455 INFO Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:41:21.4190 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:41:21.5078 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:41:21.5423 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:41:21.8923 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:41:21.9502 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:41:26.4751 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:41:26.4928 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:41:37.3504 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:41:37.3504 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:41:37.3577 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:41:37.3577 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:41:37.5372 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:41:37.5372 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:41:39.0139 INFO Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:41:39.0139 INFO Executed DbCommand (0ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:41:43.5844 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:41:43.5844 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:41:43.5955 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:41:43.5955 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:42:02.9907 INFO Executed DbCommand (9ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:42:03.1071 INFO Executed DbCommand (2ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 13:42:03.1289 INFO Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:42:03.1289 INFO Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 13:42:03.1427 INFO Executed DbCommand (2ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 13:42:03.1427 INFO Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 13:42:03.1536 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:42:03.1536 INFO Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 13:42:03.1536 INFO Executed DbCommand (1ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 13:42:03.1536 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:42:03.1734 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:42:03.1734 WARN admin 
2025-05-13 13:42:04.3727 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:42:04.3981 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 13:42:04.4954 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:42:04.5167 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 13:42:12.0755 INFO Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:42:30.6218 INFO Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:42:40.1886 INFO Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:42:46.1790 INFO Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:42:46.2324 INFO Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 13:42:46.2324 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:42:46.2324 INFO Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 13:42:46.2324 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:42:46.2324 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:42:46.2324 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:42:46.2324 WARN  
2025-05-13 13:42:50.1419 INFO Executed DbCommand (13ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:42:50.1555 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:42:50.1555 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:42:50.1702 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:42:50.3642 INFO Executed DbCommand (16ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:42:50.3954 INFO Executed DbCommand (29ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:42:52.2904 INFO Executed DbCommand (8ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:42:53.8963 INFO Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:42:53.9301 INFO Executed DbCommand (10ms) [Parameters=[@__user_UserId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b].[TourScheduleId] = [t0].[TourScheduleId]
LEFT JOIN [Images] AS [i] ON [t].[TourId] = [i].[TourId]
WHERE [b].[UserId] = @__user_UserId_0
ORDER BY [b].[BookingDate] DESC, [b].[BookingId], [t].[TourId], [t0].[TourScheduleId] 
2025-05-13 13:43:09.0075 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:43:09.0128 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:43:09.0128 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:43:09.0128 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:43:09.1939 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:43:09.2063 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:43:11.0002 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:43:11.0002 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:43:19.2751 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 13:43:19.2751 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 13:43:19.2943 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:44:01.0254 INFO Executed DbCommand (10ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 
2025-05-13 13:44:01.0381 INFO Executed DbCommand (5ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32), @__parsedDepartureDate_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 AND CONVERT(date, [t].[DepartureDate]) = @__parsedDepartureDate_Date_1 
2025-05-13 13:44:01.0444 INFO Executed DbCommand (2ms) [Parameters=[@__model_Email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__model_Email_0 
2025-05-13 13:44:01.1322 INFO Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 200), @p1='?' (Size = 200), @p2='?' (Size = 200), @p3='?' (Size = 200), @p4='?' (Size = 200), @p5='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Address], [Email], [FullName], [Password], [Phone], [Role])
OUTPUT INSERTED.[UserId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5); 
2025-05-13 13:44:01.1716 INFO Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (Size = 200), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p11='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Bookings] ([AdultQuantity], [BookingDate], [ChildQuantity], [DepartureDate], [PaymentMethod], [SpecialRequest], [TotalPrice], [TourId], [TourScheduleId], [UserId])
OUTPUT INSERTED.[BookingId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [TourSchedules] SET [RemainingSlot] = @p10
OUTPUT 1
WHERE [TourScheduleId] = @p11; 
2025-05-13 13:44:01.1716 INFO Đặt tour thành công – TourID: 36, Tên tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor", Ngày đi: "22/11/2025", Người đặt: "Ngọc KIều Ngân", Email: "ngan2004@gmail.com", Số điện thoại: "0777093325", Địa chỉ: "Nhà bè", Người lớn: 2, Trẻ em: 0, Tổng tiền: "90.000.000" đ, Thanh toán: "Quầy" 
2025-05-13 13:44:01.1881 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:44:01.1881 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:44:01.1881 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:44:01.1881 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:44:01.3912 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:44:01.4058 INFO Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:44:03.4161 INFO Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:44:04.7920 INFO Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:44:04.7970 INFO Executed DbCommand (4ms) [Parameters=[@__user_UserId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b].[TourScheduleId] = [t0].[TourScheduleId]
LEFT JOIN [Images] AS [i] ON [t].[TourId] = [i].[TourId]
WHERE [b].[UserId] = @__user_UserId_0
ORDER BY [b].[BookingDate] DESC, [b].[BookingId], [t].[TourId], [t0].[TourScheduleId] 
2025-05-13 13:44:24.8920 INFO Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:44:28.7539 INFO Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:44:28.7539 INFO Executed DbCommand (0ms) [Parameters=[@__user_UserId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b].[TourScheduleId] = [t0].[TourScheduleId]
LEFT JOIN [Images] AS [i] ON [t].[TourId] = [i].[TourId]
WHERE [b].[UserId] = @__user_UserId_0
ORDER BY [b].[BookingDate] DESC, [b].[BookingId], [t].[TourId], [t0].[TourScheduleId] 
2025-05-13 13:46:03.5508 INFO Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:46:38.8314 INFO Executed DbCommand (10ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:46:38.8839 INFO Executed DbCommand (2ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 13:46:38.8881 INFO Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:46:38.8881 INFO Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 13:46:38.8881 INFO Executed DbCommand (1ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 13:46:38.8881 INFO Executed DbCommand (2ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 13:46:38.8881 INFO Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:46:38.8881 INFO Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 13:46:38.8881 INFO Executed DbCommand (1ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 13:46:38.9034 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:46:38.9034 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:46:38.9034 WARN admin 
2025-05-13 13:46:40.0753 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:46:40.0753 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 13:46:40.1408 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:46:40.1408 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 13:46:42.1102 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 13:46:42.1102 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u] 
2025-05-13 13:46:42.1102 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t] 
2025-05-13 13:46:42.1287 INFO Executed DbCommand (1ms) [Parameters=[@__booking_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__booking_TourId_0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:47:37.9940 INFO Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 13:47:38.0054 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 13:49:23.2506 INFO Executed DbCommand (14ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:49:28.4195 INFO Executed DbCommand (11ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:49:28.4720 INFO Executed DbCommand (2ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 13:49:28.4720 INFO Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:49:28.4720 INFO Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 13:49:28.4720 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:49:28.4720 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:49:28.4829 INFO Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 13:49:28.4829 WARN  
2025-05-13 13:49:31.3018 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:49:31.3018 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:49:31.3130 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:49:31.3130 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:49:31.5310 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:49:31.5462 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:49:32.5917 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:49:32.5917 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:49:34.9704 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 13:49:34.9704 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 13:49:34.9704 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 13:49:57.4128 INFO Executed DbCommand (1ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 
2025-05-13 13:49:57.4128 INFO Executed DbCommand (3ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32), @__parsedDepartureDate_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 AND CONVERT(date, [t].[DepartureDate]) = @__parsedDepartureDate_Date_1 
2025-05-13 13:49:57.4209 INFO Executed DbCommand (2ms) [Parameters=[@__model_Email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__model_Email_0 
2025-05-13 13:49:57.4209 INFO Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (Size = 200), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p11='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Bookings] ([AdultQuantity], [BookingDate], [ChildQuantity], [DepartureDate], [PaymentMethod], [SpecialRequest], [TotalPrice], [TourId], [TourScheduleId], [UserId])
OUTPUT INSERTED.[BookingId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [TourSchedules] SET [RemainingSlot] = @p10
OUTPUT 1
WHERE [TourScheduleId] = @p11; 
2025-05-13 13:49:57.4209 INFO Đặt tour thành công – TourID: 36, Tên tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor", Ngày đi: "22/11/2025", Người đặt: "Kiều Ngân", Email: "kieungan230604@gmail.com", Số điện thoại: "0777093325", Địa chỉ: "Nhà bè", Người lớn: 1, Trẻ em: 0, Tổng tiền: "45.000.000" đ, Thanh toán: "Quầy" 
2025-05-13 13:49:57.4365 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:49:57.4365 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:49:57.4365 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:49:57.4365 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:49:57.6161 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:49:57.6161 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:49:58.8751 INFO Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:50:00.1286 INFO Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 13:50:00.1286 INFO Executed DbCommand (5ms) [Parameters=[@__user_UserId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b].[TourScheduleId] = [t0].[TourScheduleId]
LEFT JOIN [Images] AS [i] ON [t].[TourId] = [i].[TourId]
WHERE [b].[UserId] = @__user_UserId_0
ORDER BY [b].[BookingDate] DESC, [b].[BookingId], [t].[TourId], [t0].[TourScheduleId] 
2025-05-13 13:51:10.0554 INFO Executed DbCommand (11ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:51:10.0554 WARN Email đã tồn tại trong hệ thống Identity: kieungan230604@gmail.com 
2025-05-13 13:53:36.5194 INFO Executed DbCommand (38ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 13:53:36.6145 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 13:53:36.9186 INFO Now listening on: http://localhost:5062 
2025-05-13 13:53:36.9685 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 13:53:36.9685 INFO Hosting environment: Development 
2025-05-13 13:53:36.9685 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 13:53:45.5347 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:53:45.6025 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 13:53:45.6889 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 13:53:45.7108 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 13:53:45.9881 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:53:46.0408 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:53:50.4827 INFO Executed DbCommand (7ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 13:53:50.5038 INFO Executed DbCommand (8ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:53:51.1292 INFO Executed DbCommand (9ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 13:53:51.1393 INFO Executed DbCommand (9ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:53:53.1517 INFO Executed DbCommand (11ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 13:53:53.1646 INFO Executed DbCommand (11ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:53:54.2559 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:53:54.2676 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:53:55.4752 INFO Executed DbCommand (2ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 13:53:55.4752 INFO Executed DbCommand (1ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:53:56.9946 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:53:56.9982 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:53:59.2594 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:53:59.2743 INFO Executed DbCommand (6ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:53:59.2794 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:53:59.2794 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:56:10.4306 INFO Executed DbCommand (12ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:56:10.4545 INFO Executed DbCommand (10ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:56:14.0394 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:56:14.0494 INFO Executed DbCommand (8ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:56:14.0494 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:56:14.0494 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:56:18.7796 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:56:18.7796 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:56:22.6348 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:56:22.6382 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:56:22.6382 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:56:22.6382 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:56:27.9483 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:56:27.9515 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:56:27.9515 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:56:27.9515 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:56:47.3990 INFO Executed DbCommand (7ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 13:56:47.4189 INFO Executed DbCommand (10ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 13:56:47.4234 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 13:56:47.4234 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 13:56:49.7101 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 13:56:49.7101 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 13:56:49.7166 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 13:56:49.7166 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 13:56:53.1199 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 13:56:53.1236 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 13:56:53.6835 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 13:56:53.6866 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 13:56:53.7706 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 13:56:53.7706 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 13:56:56.2306 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:56:56.2344 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:56:56.2344 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:56:56.2344 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:57:06.6563 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 13:57:06.6563 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 13:57:07.9898 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 13:57:07.9898 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 13:57:07.9898 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 13:57:07.9988 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 13:57:15.1746 INFO Executed DbCommand (9ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:57:15.1859 INFO Executed DbCommand (10ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:57:15.1859 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:57:15.1859 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:57:15.9626 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:57:15.9656 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:57:22.7003 INFO Executed DbCommand (5ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 13:57:22.7130 INFO Executed DbCommand (12ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 13:57:24.4326 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 13:57:24.4355 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 13:57:24.4355 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 13:57:24.4355 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 13:57:29.7664 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:57:29.7664 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:57:29.7664 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:57:29.7664 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:57:30.3850 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:57:30.3960 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:57:36.0662 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:57:36.0849 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:57:47.1468 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:57:47.1468 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:57:52.8027 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 13:57:52.8027 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 13:58:01.7142 INFO Executed DbCommand (3ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__destination_1_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND [t].[Destination] LIKE @__destination_1_contains ESCAPE N'\' 
2025-05-13 13:58:01.7287 INFO Executed DbCommand (6ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__destination_1_contains='?' (Size = 200), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND [t].[Destination] LIKE @__destination_1_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:01.7773 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__destination_1_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND [t].[Destination] LIKE @__destination_1_contains ESCAPE N'\' 
2025-05-13 13:58:01.7799 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__destination_1_contains='?' (Size = 200), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND [t].[Destination] LIKE @__destination_1_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:05.2238 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 13:58:05.2238 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:10.6011 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__destination_1_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND [t].[Destination] LIKE @__destination_1_contains ESCAPE N'\' 
2025-05-13 13:58:10.6011 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__destination_1_contains='?' (Size = 200), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND [t].[Destination] LIKE @__destination_1_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:11.0016 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__destination_1_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND [t].[Destination] LIKE @__destination_1_contains ESCAPE N'\' 
2025-05-13 13:58:11.0016 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__destination_1_contains='?' (Size = 200), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND [t].[Destination] LIKE @__destination_1_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:14.9121 INFO Executed DbCommand (4ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 13:58:14.9327 INFO Executed DbCommand (10ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:14.9369 INFO Executed DbCommand (1ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 13:58:14.9369 INFO Executed DbCommand (1ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:15.5679 INFO Executed DbCommand (4ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 13:58:15.5769 INFO Executed DbCommand (8ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:19.5123 INFO Executed DbCommand (11ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 13:58:19.5362 INFO Executed DbCommand (23ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:19.9105 INFO Executed DbCommand (7ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 13:58:19.9208 INFO Executed DbCommand (10ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:25.6604 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:58:25.6604 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:28.7776 INFO Executed DbCommand (1ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 13:58:28.7803 INFO Executed DbCommand (1ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:29.1853 INFO Executed DbCommand (1ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 13:58:29.1853 INFO Executed DbCommand (1ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:31.6011 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:58:31.6011 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:34.2994 INFO Executed DbCommand (1ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 13:58:34.2994 INFO Executed DbCommand (1ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:35.7399 INFO Executed DbCommand (1ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 13:58:35.7399 INFO Executed DbCommand (1ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:37.1317 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:58:37.1317 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:39.9399 INFO Executed DbCommand (1ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 13:58:39.9399 INFO Executed DbCommand (1ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:41.8074 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:58:41.8128 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 13:58:43.4572 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 13:58:43.4572 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:01:06.0710 INFO Executed DbCommand (40ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:01:06.1544 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:01:06.3912 INFO Now listening on: http://localhost:5062 
2025-05-13 14:01:06.4444 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 14:01:06.4444 INFO Hosting environment: Development 
2025-05-13 14:01:06.4444 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 14:01:53.2179 INFO Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:01:53.2953 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:01:53.3876 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:01:53.4133 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:01:53.7228 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:01:53.7779 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:03:01.4072 INFO Executed DbCommand (38ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:03:01.5056 INFO Executed DbCommand (17ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:03:01.7397 INFO Now listening on: http://localhost:5062 
2025-05-13 14:03:01.7892 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 14:03:01.7892 INFO Hosting environment: Development 
2025-05-13 14:03:01.7892 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 14:03:41.3670 INFO Executed DbCommand (34ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:03:41.4587 INFO Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:03:41.7221 INFO Now listening on: http://localhost:5062 
2025-05-13 14:03:41.7812 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 14:03:41.7812 INFO Hosting environment: Development 
2025-05-13 14:03:41.7812 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 14:04:17.0116 INFO Executed DbCommand (38ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:04:17.0974 INFO Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:04:17.3209 INFO Now listening on: http://localhost:5062 
2025-05-13 14:04:17.3791 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 14:04:17.3791 INFO Hosting environment: Development 
2025-05-13 14:04:17.3791 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 14:04:38.4542 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:04:38.5538 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:04:38.6375 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:04:38.6639 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:04:39.0175 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:04:39.0812 INFO Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:04:42.6199 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:04:42.6438 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:04:43.3911 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:04:43.3911 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:04:43.8912 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:04:43.8912 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:06:05.3818 INFO Executed DbCommand (38ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:06:05.4616 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:06:05.7002 INFO Now listening on: http://localhost:5062 
2025-05-13 14:06:05.7554 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 14:06:05.7554 INFO Hosting environment: Development 
2025-05-13 14:06:05.7554 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 14:06:24.9973 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:06:25.0714 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:06:25.1540 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:06:25.1820 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:06:25.5050 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:06:25.5553 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:06:26.5921 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 14:06:26.6166 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 14:07:46.2612 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:07:46.2686 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:07:46.2686 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:07:46.2686 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:07:46.4566 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:07:46.4734 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:07:48.0110 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 14:07:48.0155 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 14:07:50.9253 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:07:50.9253 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:07:50.9253 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:07:50.9253 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:07:51.1093 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:07:51.1093 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:07:52.5114 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 14:07:52.5142 INFO Executed DbCommand (0ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 14:07:54.9431 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 14:07:54.9431 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 14:07:54.9655 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 14:09:15.1098 INFO Executed DbCommand (41ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:09:15.1931 INFO Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:09:15.4340 INFO Now listening on: http://localhost:5062 
2025-05-13 14:09:15.4884 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 14:09:15.4884 INFO Hosting environment: Development 
2025-05-13 14:09:15.4884 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 14:09:18.0578 INFO Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:09:18.1320 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:09:18.2148 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:09:18.2382 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:09:18.5745 INFO Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:09:18.6324 INFO Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:09:24.0229 INFO Executed DbCommand (15ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 14:09:24.0496 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 14:09:27.1215 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 14:09:27.1267 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 14:09:27.1457 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 14:10:54.9041 INFO Executed DbCommand (38ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:10:54.9834 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:10:55.2103 INFO Now listening on: http://localhost:5062 
2025-05-13 14:10:55.2594 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 14:10:55.2594 INFO Hosting environment: Development 
2025-05-13 14:10:55.2594 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 14:11:07.6102 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:11:07.7024 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:11:07.8045 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:11:07.8391 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:11:08.1810 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:11:08.2502 INFO Executed DbCommand (16ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:11:09.8415 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 14:11:09.8653 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 14:11:20.9029 INFO Executed DbCommand (3ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 14:11:20.9070 INFO Người dùng mở trang đặt tour: "Tour Ai Cập 7N6Đ – Cairo – Luxor" – Ngày đi: "22/11/2025" 
2025-05-13 14:11:20.9238 INFO Executed DbCommand (2ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 14:12:19.1850 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:12:19.1850 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:12:19.1850 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:12:19.2015 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:12:19.3779 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:12:19.3929 INFO Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:12:20.4022 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 14:12:20.4061 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 14:14:07.7105 INFO Executed DbCommand (28ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:14:07.7781 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:14:07.9017 INFO Now listening on: http://localhost:5062 
2025-05-13 14:14:07.9389 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 14:14:07.9389 INFO Hosting environment: Development 
2025-05-13 14:14:07.9389 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 14:14:33.9680 INFO Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:14:34.0557 INFO Executed DbCommand (2ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 14:14:34.0750 INFO Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 14:14:34.0750 INFO Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 14:14:34.0750 INFO Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 14:14:34.0945 INFO Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 14:14:34.1118 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 14:14:34.1118 WARN  
2025-05-13 14:14:39.0549 INFO Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:14:42.4591 INFO Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:14:42.5195 INFO Executed DbCommand (10ms) [Parameters=[@__user_UserId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b].[TourScheduleId] = [t0].[TourScheduleId]
LEFT JOIN [Images] AS [i] ON [t].[TourId] = [i].[TourId]
WHERE [b].[UserId] = @__user_UserId_0
ORDER BY [b].[BookingDate] DESC, [b].[BookingId], [t].[TourId], [t0].[TourScheduleId] 
2025-05-13 14:14:46.3400 INFO Executed DbCommand (9ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:14:49.5154 INFO Executed DbCommand (10ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:14:49.5435 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:14:49.5738 INFO Executed DbCommand (10ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:14:49.5955 INFO Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:14:49.8286 INFO Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:14:49.8881 INFO Executed DbCommand (17ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:15:00.8964 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:15:00.8964 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:15:00.9069 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:15:00.9069 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:15:01.0814 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:15:01.0814 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:15:03.4467 INFO Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:15:06.0476 INFO Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:15:11.2822 INFO Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:15:13.9455 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:15:13.9455 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:15:13.9455 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:15:13.9455 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:15:14.1168 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:15:14.1168 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:15:16.0786 INFO Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:16:05.1847 INFO Executed DbCommand (8ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:16:58.3613 INFO Executed DbCommand (38ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:16:58.4414 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:16:58.6854 INFO Now listening on: http://localhost:5062 
2025-05-13 14:16:58.7443 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 14:16:58.7443 INFO Hosting environment: Development 
2025-05-13 14:16:58.7443 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 14:17:05.9280 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:17:06.0219 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:17:06.1314 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:17:06.1632 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:17:06.5415 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:17:06.6126 INFO Executed DbCommand (14ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:17:11.2929 INFO Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:17:34.8325 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:17:34.8325 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:17:34.8423 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:17:34.8423 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:17:35.0713 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:17:35.0778 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:17:37.8339 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:17:37.8339 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:17:37.8339 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:17:37.8339 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:17:38.0589 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:17:38.0643 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:17:42.5232 INFO Executed DbCommand (0ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:18:33.4344 INFO Executed DbCommand (38ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:18:33.5122 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:18:33.7692 INFO Now listening on: http://localhost:5062 
2025-05-13 14:18:33.8224 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 14:18:33.8224 INFO Hosting environment: Development 
2025-05-13 14:18:33.8224 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 14:18:38.5986 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:18:38.6876 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:18:38.7877 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:18:38.8205 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:18:39.2863 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:18:39.3467 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:18:51.7357 INFO Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:18:55.3049 INFO Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:18:55.3406 INFO Executed DbCommand (4ms) [Parameters=[@__user_UserId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b].[TourScheduleId] = [t0].[TourScheduleId]
LEFT JOIN [Images] AS [i] ON [t].[TourId] = [i].[TourId]
WHERE [b].[UserId] = @__user_UserId_0
ORDER BY [b].[BookingDate] DESC, [b].[BookingId], [t].[TourId], [t0].[TourScheduleId] 
2025-05-13 14:18:58.9674 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:18:58.9674 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:18:58.9674 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:18:58.9674 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:18:59.2971 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:18:59.2971 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:20:42.4709 INFO Executed DbCommand (30ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:20:42.5398 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:20:42.6658 INFO Now listening on: http://localhost:5062 
2025-05-13 14:20:42.7032 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 14:20:42.7032 INFO Hosting environment: Development 
2025-05-13 14:20:42.7032 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 14:21:20.5469 INFO Executed DbCommand (34ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:21:20.6357 INFO Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:21:20.9270 INFO Now listening on: http://localhost:5062 
2025-05-13 14:21:20.9805 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 14:21:20.9805 INFO Hosting environment: Development 
2025-05-13 14:21:20.9805 INFO Content root path: C:\Users\MY COMPUTER\Downloads\52200146_52200157_52200318\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 14:21:33.2363 INFO Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:21:33.3100 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:21:33.3905 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:21:33.4161 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:21:33.7913 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:21:33.8434 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:21:42.8304 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:21:42.8304 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:21:42.8304 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:21:42.8412 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:21:43.2186 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:21:43.2186 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:21:45.7171 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:21:45.7368 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:21:46.6341 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:21:46.6390 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:21:47.4175 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:21:47.4221 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:55:19.7094 INFO Executed DbCommand (114ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:55:19.8388 INFO Executed DbCommand (14ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:55:20.4633 INFO Now listening on: http://localhost:5062 
2025-05-13 14:55:20.5473 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 14:55:20.5473 INFO Hosting environment: Development 
2025-05-13 14:55:20.5473 INFO Content root path: C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 14:55:43.0137 INFO Executed DbCommand (24ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:55:43.1718 INFO Executed DbCommand (41ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:55:43.3735 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:55:43.4302 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:55:44.0360 INFO Executed DbCommand (8ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:55:44.1891 INFO Executed DbCommand (41ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:56:07.2284 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:56:07.2381 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:56:07.2486 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:56:07.2486 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:56:07.3420 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:56:07.3631 INFO Executed DbCommand (17ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:56:17.2929 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:56:17.3224 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:56:25.6479 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:56:25.6643 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:56:28.9797 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:56:28.9969 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:57:16.9540 INFO Executed DbCommand (6ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 14:57:17.1586 INFO Executed DbCommand (6ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 14:57:17.1934 INFO Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 14:57:17.1995 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:57:17.2138 INFO Executed DbCommand (4ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 14:57:17.2379 INFO Executed DbCommand (2ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 14:57:17.2379 INFO Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 14:57:17.2484 INFO Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 14:57:17.2484 INFO Executed DbCommand (1ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 14:57:17.2484 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 14:57:17.3357 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 14:57:17.3395 WARN admin 
2025-05-13 14:57:19.8630 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:57:19.9355 INFO Executed DbCommand (29ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 14:57:20.1551 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:57:20.1874 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 14:57:22.5124 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:57:22.5356 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 14:57:24.1667 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:57:24.1667 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 14:57:24.6710 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:57:24.6710 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 14:57:25.9430 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:57:25.9468 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 14:57:31.9641 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:57:33.5789 INFO Executed DbCommand (14ms) [Parameters=[@__year_Value_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b]
WHERE DATEPART(year, [b].[DepartureDate]) = @__year_Value_0 
2025-05-13 14:57:33.6042 INFO Executed DbCommand (6ms) [Parameters=[@__year_Value_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COALESCE(SUM([b].[TotalPrice]), 0.0)
FROM [Bookings] AS [b]
WHERE DATEPART(year, [b].[DepartureDate]) = @__year_Value_0 
2025-05-13 14:57:33.6574 INFO Executed DbCommand (14ms) [Parameters=[@__year_Value_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryName] AS [Region], COUNT(*) AS [Count]
FROM [Bookings] AS [b]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
INNER JOIN [Categories] AS [c] ON [t].[CategoryId] = [c].[CategoryId]
WHERE DATEPART(year, [b].[DepartureDate]) = @__year_Value_0
GROUP BY [c].[CategoryName] 
2025-05-13 14:57:33.6771 INFO Executed DbCommand (11ms) [Parameters=[@__year_Value_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b].[PaymentMethod] AS [Method], COUNT(*) AS [Count]
FROM [Bookings] AS [b]
WHERE DATEPART(year, [b].[DepartureDate]) = @__year_Value_0
GROUP BY [b].[PaymentMethod] 
2025-05-13 14:57:33.6982 INFO Executed DbCommand (7ms) [Parameters=[@__year_Value_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[Key] AS [Month], COALESCE(SUM([b0].[TotalPrice]), 0.0) AS [Revenue]
FROM (
    SELECT [b].[TotalPrice], DATEPART(month, [b].[DepartureDate]) AS [Key]
    FROM [Bookings] AS [b]
    WHERE DATEPART(year, [b].[DepartureDate]) = @__year_Value_0
) AS [b0]
GROUP BY [b0].[Key] 
2025-05-13 14:57:33.7105 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:57:40.5972 INFO Executed DbCommand (8ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin' 
2025-05-13 14:57:40.6081 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin'
ORDER BY [u].[UserId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY 
2025-05-13 14:57:41.5798 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:57:41.5798 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 14:57:41.6391 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:57:41.6391 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 14:57:43.7750 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:57:43.7784 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 14:57:45.0075 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:57:45.0112 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 14:57:45.4652 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:57:45.4652 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 14:57:46.5432 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:57:46.5432 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 14:57:50.4560 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin' 
2025-05-13 14:57:50.4560 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin'
ORDER BY [u].[UserId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY 
2025-05-13 14:57:51.7505 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:57:52.3713 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:57:52.3713 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 14:57:52.4301 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:57:52.4301 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 14:57:53.2459 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 14:57:53.2723 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:57:53.2782 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:57:53.3881 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:57:53.4141 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 14:57:53.4141 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 14:57:58.3844 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin' 
2025-05-13 14:57:58.3844 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin'
ORDER BY [u].[UserId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY 
2025-05-13 14:58:01.1651 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:58:01.1703 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 14:58:01.2388 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:58:01.2388 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 14:58:02.3739 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin' 
2025-05-13 14:58:02.3739 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin'
ORDER BY [u].[UserId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY 
2025-05-13 14:58:03.5228 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:58:03.5272 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 14:58:03.5879 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:58:03.5879 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 14:58:05.3097 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin' 
2025-05-13 14:58:05.3097 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin'
ORDER BY [u].[UserId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY 
2025-05-13 14:58:08.4394 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:58:08.4453 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 14:58:08.5202 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 14:58:08.5202 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 14:58:10.6105 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin' 
2025-05-13 14:58:10.6105 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin'
ORDER BY [u].[UserId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY 
2025-05-13 14:58:36.6321 INFO Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:58:38.7846 INFO Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:58:38.8281 INFO Executed DbCommand (14ms) [Parameters=[@__user_UserId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b].[TourScheduleId] = [t0].[TourScheduleId]
LEFT JOIN [Images] AS [i] ON [t].[TourId] = [i].[TourId]
WHERE [b].[UserId] = @__user_UserId_0
ORDER BY [b].[BookingDate] DESC, [b].[BookingId], [t].[TourId], [t0].[TourScheduleId] 
2025-05-13 14:58:40.7560 INFO Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 14:58:53.5378 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:58:53.5473 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 14:58:53.5473 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 14:58:53.5562 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 14:58:54.0614 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 14:58:54.0834 INFO Executed DbCommand (19ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:59:06.0050 INFO Executed DbCommand (13ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 14:59:06.0348 INFO Executed DbCommand (10ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:59:06.0418 INFO Executed DbCommand (2ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 14:59:06.0418 INFO Executed DbCommand (2ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:59:06.4144 INFO Executed DbCommand (2ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 14:59:06.4144 INFO Executed DbCommand (2ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 14:59:07.7315 INFO Executed DbCommand (15ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 14:59:07.7557 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:00:14.8710 INFO Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:00:14.8871 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:07:18.6479 INFO Executed DbCommand (125ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 15:07:18.7781 INFO Executed DbCommand (8ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 15:07:19.2995 INFO Now listening on: http://localhost:5062 
2025-05-13 15:07:19.3785 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 15:07:19.3785 INFO Hosting environment: Development 
2025-05-13 15:07:19.3785 INFO Content root path: C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 15:07:27.7821 INFO Executed DbCommand (24ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:07:27.9079 INFO Executed DbCommand (37ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 15:07:28.0478 INFO Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:07:28.0960 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:07:28.5408 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:07:28.6884 INFO Executed DbCommand (60ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:07:44.7358 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 15:07:44.7676 INFO Executed DbCommand (14ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:07:44.7834 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 15:07:44.7926 INFO Executed DbCommand (3ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:08:18.1659 INFO Executed DbCommand (11ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 15:08:18.1966 INFO Executed DbCommand (20ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:08:18.1966 INFO Executed DbCommand (6ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 15:08:18.2505 INFO Executed DbCommand (30ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:08:24.3016 INFO Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:08:24.3385 INFO Executed DbCommand (7ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:08:43.8360 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:08:43.8420 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:08:55.6862 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:08:56.6897 INFO Executed DbCommand (13ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin' 
2025-05-13 15:08:56.7064 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin'
ORDER BY [u].[UserId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY 
2025-05-13 15:08:59.1741 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:08:59.2331 INFO Executed DbCommand (16ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 15:08:59.3938 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:08:59.4276 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:09:04.0419 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:09:04.0693 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:09:04.4733 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:09:04.4733 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:09:04.8753 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:09:04.8753 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:09:06.2858 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:09:06.2901 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:09:26.7759 INFO Executed DbCommand (19ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:09:26.7759 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:09:35.6447 INFO Executed DbCommand (6ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t0].[TourId], [t0].[AdultPrice], [t0].[Capacity], [t0].[CategoryId], [t0].[ChildPrice], [t0].[Description], [t0].[Destination], [t0].[Duration], [t0].[Itinerary], [t0].[Title], [t0].[Transport], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__tourId_0
) AS [t0]
LEFT JOIN [Images] AS [i] ON [t0].[TourId] = [i].[TourId]
ORDER BY [t0].[TourId] 
2025-05-13 15:09:35.6555 INFO Người dùng mở trang đặt tour: "Tour Nhật Bản Tokyo – Núi Phú Sĩ 6N5Đ" – Ngày đi: "24/12/2025" 
2025-05-13 15:09:35.6822 INFO Executed DbCommand (5ms) [Parameters=[@__tourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__tourId_0 AND [t].[RemainingSlot] > 0
ORDER BY [t].[DepartureDate] 
2025-05-13 15:10:57.7974 INFO Executed DbCommand (10ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 
2025-05-13 15:10:57.8336 INFO Executed DbCommand (19ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32), @__parsedDepartureDate_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__model_TourId_0 AND CONVERT(date, [t].[DepartureDate]) = @__parsedDepartureDate_Date_1 
2025-05-13 15:10:57.8470 INFO Executed DbCommand (6ms) [Parameters=[@__model_Email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__model_Email_0 
2025-05-13 15:10:58.0430 INFO Executed DbCommand (17ms) [Parameters=[@p0='?' (Size = 200), @p1='?' (Size = 200), @p2='?' (Size = 200), @p3='?' (Size = 200), @p4='?' (Size = 200), @p5='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Address], [Email], [FullName], [Password], [Phone], [Role])
OUTPUT INSERTED.[UserId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5); 
2025-05-13 15:10:58.1404 INFO Executed DbCommand (21ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (Size = 200), @p6='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (DbType = Int32), @p11='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Bookings] ([AdultQuantity], [BookingDate], [ChildQuantity], [DepartureDate], [PaymentMethod], [SpecialRequest], [TotalPrice], [TourId], [TourScheduleId], [UserId])
OUTPUT INSERTED.[BookingId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
UPDATE [TourSchedules] SET [RemainingSlot] = @p10
OUTPUT 1
WHERE [TourScheduleId] = @p11; 
2025-05-13 15:10:58.1535 INFO Đặt tour thành công – TourID: 28, Tên tour: "Tour Nhật Bản Tokyo – Núi Phú Sĩ 6N5Đ", Ngày đi: "24/12/2025", Người đặt: "Bảo Hân", Email: "baohan@gmail.com", Số điện thoại: "055412789", Địa chỉ: "Sóc Trăng", Người lớn: 2, Trẻ em: 1, Tổng tiền: "50,500,000" đ, Thanh toán: "MoMo" 
2025-05-13 15:10:58.1707 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:10:58.1707 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 15:10:58.1908 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:10:58.1908 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:10:58.5397 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:10:58.5618 INFO Executed DbCommand (18ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:11:03.9520 INFO Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:11:03.9520 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:11:11.2398 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:11:11.2495 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 15:11:11.3167 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:11:11.3271 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:11:16.3377 INFO Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 15:11:16.3377 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u] 
2025-05-13 15:11:16.3619 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t] 
2025-05-13 15:11:16.3963 INFO Executed DbCommand (4ms) [Parameters=[@__booking_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__booking_TourId_0
ORDER BY [t].[DepartureDate] 
2025-05-13 15:11:27.6400 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:11:27.6571 INFO Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 15:11:27.7171 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:11:27.7292 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:11:28.9109 INFO Executed DbCommand (12ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 15:11:28.9176 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u] 
2025-05-13 15:11:28.9176 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t] 
2025-05-13 15:11:28.9309 INFO Executed DbCommand (6ms) [Parameters=[@__booking_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__booking_TourId_0
ORDER BY [t].[DepartureDate] 
2025-05-13 15:11:30.6306 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:11:30.6306 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 15:11:30.6859 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:11:30.6859 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:11:31.8293 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 15:11:31.8293 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u] 
2025-05-13 15:11:31.8293 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t] 
2025-05-13 15:11:31.8293 INFO Executed DbCommand (1ms) [Parameters=[@__booking_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__booking_TourId_0
ORDER BY [t].[DepartureDate] 
2025-05-13 15:11:36.6542 INFO Executed DbCommand (22ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
LEFT JOIN [TourSchedules] AS [t] ON [b].[TourScheduleId] = [t].[TourScheduleId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 15:11:36.6716 INFO Executed DbCommand (4ms) [Parameters=[@__existing_TourScheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__existing_TourScheduleId_0 
2025-05-13 15:11:36.6843 INFO Executed DbCommand (4ms) [Parameters=[@__existing_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__existing_TourId_0 
2025-05-13 15:11:36.6843 INFO Executed DbCommand (7ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 4000)], CommandType='Text', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Bookings] SET [BookingDate] = @p0, [PaymentMethod] = @p1
OUTPUT 1
WHERE [BookingId] = @p2; 
2025-05-13 15:11:36.6843 INFO Admin đã chỉnh sửa booking #28 – Người đặt: Bảo Hân 
2025-05-13 15:11:36.7088 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:11:36.7198 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 15:11:36.7922 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:11:36.8131 INFO Executed DbCommand (20ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:11:45.2256 INFO Executed DbCommand (16ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 15:11:45.2308 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u] 
2025-05-13 15:11:45.2308 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t] 
2025-05-13 15:11:45.2308 INFO Executed DbCommand (6ms) [Parameters=[@__booking_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__booking_TourId_0
ORDER BY [t].[DepartureDate] 
2025-05-13 15:11:58.9473 INFO Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
LEFT JOIN [TourSchedules] AS [t] ON [b].[TourScheduleId] = [t].[TourScheduleId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 15:11:58.9473 INFO Executed DbCommand (5ms) [Parameters=[@__existing_TourScheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__existing_TourScheduleId_0 
2025-05-13 15:11:58.9473 INFO Executed DbCommand (2ms) [Parameters=[@__existing_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__existing_TourId_0 
2025-05-13 15:11:58.9681 INFO Executed DbCommand (7ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32), @p3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Bookings] SET [ChildQuantity] = @p0, [TotalPrice] = @p1
OUTPUT 1
WHERE [BookingId] = @p2;
UPDATE [TourSchedules] SET [RemainingSlot] = @p3
OUTPUT 1
WHERE [TourScheduleId] = @p4; 
2025-05-13 15:11:58.9681 INFO Admin đã chỉnh sửa booking #28 – Người đặt: Bảo Hân 
2025-05-13 15:11:58.9830 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:11:58.9920 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 15:11:59.0606 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:11:59.0741 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:12:00.1362 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 15:12:00.1362 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u] 
2025-05-13 15:12:00.1362 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t] 
2025-05-13 15:12:00.1362 INFO Executed DbCommand (1ms) [Parameters=[@__booking_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__booking_TourId_0
ORDER BY [t].[DepartureDate] 
2025-05-13 15:12:09.7210 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
LEFT JOIN [TourSchedules] AS [t] ON [b].[TourScheduleId] = [t].[TourScheduleId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 15:12:09.7210 INFO Executed DbCommand (1ms) [Parameters=[@__existing_TourScheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__existing_TourScheduleId_0 
2025-05-13 15:12:09.7210 INFO Executed DbCommand (1ms) [Parameters=[@__existing_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t]
WHERE [t].[TourId] = @__existing_TourId_0 
2025-05-13 15:12:09.7348 INFO Executed DbCommand (5ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [FullName] = @p0
OUTPUT 1
WHERE [UserId] = @p1; 
2025-05-13 15:12:09.7348 INFO Admin đã chỉnh sửa booking #28 – Người đặt: Lê Bảo Hân 
2025-05-13 15:12:09.7492 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:12:09.7492 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 15:12:09.8157 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:12:09.8157 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:12:11.1275 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin' 
2025-05-13 15:12:11.1331 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin'
ORDER BY [u].[UserId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY 
2025-05-13 15:12:13.1456 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin' 
2025-05-13 15:12:13.1560 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin'
ORDER BY [u].[UserId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY 
2025-05-13 15:12:15.3749 INFO Executed DbCommand (13ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [u0].[UserId], [u0].[Address], [u0].[Email], [u0].[FullName], [u0].[Password], [u0].[Phone], [u0].[Role], [s].[BookingId], [s].[AdultQuantity], [s].[BookingDate], [s].[ChildQuantity], [s].[DepartureDate], [s].[PaymentMethod], [s].[SpecialRequest], [s].[TotalPrice], [s].[TourId], [s].[TourScheduleId], [s].[UserId], [s].[TourId0], [s].[AdultPrice], [s].[Capacity], [s].[CategoryId], [s].[ChildPrice], [s].[Description], [s].[Destination], [s].[Duration], [s].[Itinerary], [s].[Title], [s].[Transport]
FROM (
    SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
    FROM [Users] AS [u]
    WHERE [u].[UserId] = @__id_0
) AS [u0]
LEFT JOIN (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [t].[TourId] AS [TourId0], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Bookings] AS [b]
    INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
) AS [s] ON [u0].[UserId] = [s].[UserId]
ORDER BY [u0].[UserId], [s].[BookingId] 
2025-05-13 15:12:15.3842 INFO Admin xem chi tiết người dùng ID: 20 
2025-05-13 15:12:20.0992 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin' 
2025-05-13 15:12:20.1046 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin'
ORDER BY [u].[UserId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY 
2025-05-13 15:12:22.7726 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:12:22.7726 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 15:12:22.8511 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:12:22.8511 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:12:23.6620 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:12:25.5019 INFO Executed DbCommand (12ms) [Parameters=[@__year_Value_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b]
WHERE DATEPART(year, [b].[DepartureDate]) = @__year_Value_0 
2025-05-13 15:12:25.5327 INFO Executed DbCommand (6ms) [Parameters=[@__year_Value_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COALESCE(SUM([b].[TotalPrice]), 0.0)
FROM [Bookings] AS [b]
WHERE DATEPART(year, [b].[DepartureDate]) = @__year_Value_0 
2025-05-13 15:12:25.5916 INFO Executed DbCommand (13ms) [Parameters=[@__year_Value_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryName] AS [Region], COUNT(*) AS [Count]
FROM [Bookings] AS [b]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
INNER JOIN [Categories] AS [c] ON [t].[CategoryId] = [c].[CategoryId]
WHERE DATEPART(year, [b].[DepartureDate]) = @__year_Value_0
GROUP BY [c].[CategoryName] 
2025-05-13 15:12:25.6152 INFO Executed DbCommand (12ms) [Parameters=[@__year_Value_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b].[PaymentMethod] AS [Method], COUNT(*) AS [Count]
FROM [Bookings] AS [b]
WHERE DATEPART(year, [b].[DepartureDate]) = @__year_Value_0
GROUP BY [b].[PaymentMethod] 
2025-05-13 15:12:25.6406 INFO Executed DbCommand (8ms) [Parameters=[@__year_Value_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[Key] AS [Month], COALESCE(SUM([b0].[TotalPrice]), 0.0) AS [Revenue]
FROM (
    SELECT [b].[TotalPrice], DATEPART(month, [b].[DepartureDate]) AS [Key]
    FROM [Bookings] AS [b]
    WHERE DATEPART(year, [b].[DepartureDate]) = @__year_Value_0
) AS [b0]
GROUP BY [b0].[Key] 
2025-05-13 15:12:25.6406 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:13:07.0493 INFO Executed DbCommand (8ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin' 
2025-05-13 15:13:07.0493 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Role] <> N'admin'
ORDER BY [u].[UserId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY 
2025-05-13 15:13:09.8615 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:13:09.8724 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 15:13:09.9172 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:13:09.9172 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:13:12.0213 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 15:13:12.0241 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u] 
2025-05-13 15:13:12.0241 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t] 
2025-05-13 15:13:12.0241 INFO Executed DbCommand (3ms) [Parameters=[@__booking_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__booking_TourId_0
ORDER BY [t].[DepartureDate] 
2025-05-13 15:13:56.4769 INFO Executed DbCommand (11ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__categoryId_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' AND [t].[CategoryId] = @__categoryId_1 
2025-05-13 15:13:56.5067 INFO Executed DbCommand (10ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__categoryId_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' AND [t].[CategoryId] = @__categoryId_1
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:13:57.6176 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:13:57.6176 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:14:04.9954 INFO Executed DbCommand (4ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__categoryId_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' AND [t].[CategoryId] = @__categoryId_1 
2025-05-13 15:14:04.9954 INFO Executed DbCommand (9ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__categoryId_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' AND [t].[CategoryId] = @__categoryId_1
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:14:07.0990 INFO Executed DbCommand (5ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__categoryId_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' AND [t].[CategoryId] = @__categoryId_1 
2025-05-13 15:14:07.1104 INFO Executed DbCommand (9ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__categoryId_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' AND [t].[CategoryId] = @__categoryId_1
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:14:07.7863 INFO Executed DbCommand (3ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__categoryId_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' AND [t].[CategoryId] = @__categoryId_1 
2025-05-13 15:14:07.7953 INFO Executed DbCommand (8ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__categoryId_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' AND [t].[CategoryId] = @__categoryId_1
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:14:08.1944 INFO Executed DbCommand (3ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__categoryId_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' AND [t].[CategoryId] = @__categoryId_1 
2025-05-13 15:14:08.2036 INFO Executed DbCommand (8ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__categoryId_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' AND [t].[CategoryId] = @__categoryId_1
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:14:11.9200 INFO Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:14:11.9200 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:14:20.2225 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:14:20.2275 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 15:14:20.2275 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:14:20.2275 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:14:20.2808 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:14:20.2952 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:14:22.8690 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:14:22.8690 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:14:28.1779 INFO Executed DbCommand (3ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 15:14:28.1951 INFO Executed DbCommand (7ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:14:29.3729 INFO Executed DbCommand (1ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 15:14:29.3729 INFO Executed DbCommand (1ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:14:30.0755 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:14:30.0755 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:14:35.0888 INFO Executed DbCommand (4ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 15:14:35.0888 INFO Executed DbCommand (9ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:14:36.1351 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:14:36.1351 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:14:55.4583 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:14:55.4684 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 15:14:55.5669 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:14:55.5763 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:14:56.7015 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 15:14:56.7015 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u] 
2025-05-13 15:14:56.7015 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t] 
2025-05-13 15:14:56.7015 INFO Executed DbCommand (2ms) [Parameters=[@__booking_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__booking_TourId_0
ORDER BY [t].[DepartureDate] 
2025-05-13 15:15:14.3781 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:15:14.3859 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingDate] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingDate] DESC 
2025-05-13 15:15:14.4237 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Bookings] AS [b] 
2025-05-13 15:15:14.4321 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b0].[BookingId], [b0].[AdultQuantity], [b0].[BookingDate], [b0].[ChildQuantity], [b0].[DepartureDate], [b0].[PaymentMethod], [b0].[SpecialRequest], [b0].[TotalPrice], [b0].[TourId], [b0].[TourScheduleId], [b0].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId]
    FROM [Bookings] AS [b]
    ORDER BY [b].[BookingId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Users] AS [u] ON [b0].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b0].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b0].[TourScheduleId] = [t0].[TourScheduleId]
ORDER BY [b0].[BookingId] DESC 
2025-05-13 15:15:16.7237 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Bookings] AS [b]
INNER JOIN [Users] AS [u] ON [b].[UserId] = [u].[UserId]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
WHERE [b].[BookingId] = @__id_0 
2025-05-13 15:15:16.7262 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u] 
2025-05-13 15:15:16.7262 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
FROM [Tours] AS [t] 
2025-05-13 15:15:16.7262 INFO Executed DbCommand (2ms) [Parameters=[@__booking_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourId] = @__booking_TourId_0
ORDER BY [t].[DepartureDate] 
2025-05-13 15:16:13.5623 INFO Executed DbCommand (8ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:16:13.5765 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:16:13.5765 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:16:13.6990 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:16:13.7213 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:16:13.7274 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:16:19.4434 INFO Executed DbCommand (3ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 15:16:19.4590 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:16:19.4644 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:16:23.5031 INFO Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:16:23.5204 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:16:46.3807 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:16:46.3844 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:16:46.3844 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:16:46.4346 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:16:46.4346 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:16:46.4453 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:16:50.2753 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 15:16:50.2753 INFO Executed DbCommand (3ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:16:50.2753 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:16:52.6522 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:16:52.6522 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:17:10.6206 INFO Executed DbCommand (8ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:17:10.6206 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:17:10.6206 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:17:10.6636 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:17:10.6700 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:17:10.6700 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:17:15.9450 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 15:17:15.9503 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:17:15.9503 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:17:21.7740 INFO Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:17:21.7740 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:17:32.1851 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:17:32.1851 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:17:32.1851 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:17:32.2444 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:17:32.2444 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:17:32.2574 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:17:34.4413 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:17:34.4583 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:17:34.4621 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:17:35.0885 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:17:35.0885 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:17:35.0885 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:17:37.9055 INFO Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:17:37.9055 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:17:37.9165 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:17:44.7068 INFO Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:17:44.7115 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:17:44.7115 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:17:46.9373 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:17:46.9373 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:17:46.9465 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:28:09.2344 INFO Executed DbCommand (105ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 15:28:09.4541 INFO Executed DbCommand (120ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 15:28:09.9022 INFO Now listening on: http://localhost:5062 
2025-05-13 15:28:09.9756 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 15:28:09.9756 INFO Hosting environment: Development 
2025-05-13 15:28:09.9756 INFO Content root path: C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 15:28:17.9484 INFO Executed DbCommand (26ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:28:18.0671 INFO Executed DbCommand (51ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 15:28:18.1667 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:28:18.2000 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:28:18.6304 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:28:18.7454 INFO Executed DbCommand (36ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:28:21.8186 INFO Executed DbCommand (15ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:28:21.8401 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:28:44.0610 INFO Executed DbCommand (8ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:28:44.0610 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 15:28:44.0779 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:28:44.0779 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:28:44.1687 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:28:44.2014 INFO Executed DbCommand (27ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:28:47.4363 INFO Executed DbCommand (17ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 15:28:47.4606 INFO Executed DbCommand (10ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:28:48.3648 INFO Executed DbCommand (16ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:28:48.3745 INFO Executed DbCommand (5ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:29:01.7874 INFO Executed DbCommand (13ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:29:01.8013 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:29:01.8082 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:29:02.3457 INFO Executed DbCommand (12ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:29:02.3812 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:29:02.3898 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:29:08.4815 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 15:29:08.4947 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:29:08.4947 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:29:12.4846 INFO Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:29:12.4964 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:29:12.9559 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: Cannot convert type 'System.Collections.Generic.List<<>f__AnonymousType9<int,string,string,int,bool>>' to 'System.Collections.Generic.List<object>'
   at CallSite.Target(Closure, CallSite, Object)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute1[T0,TRet](CallSite site, T0 arg0)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:33:01.4489 ERROR An error occurred using the connection to database 'TourBookingDB' on server '.\SQLEXPRESS'. 
2025-05-13 15:33:01.5309 ERROR An exception occurred while iterating over the results of a query for context type 'TourBookingWeb.Data.TourDBContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed during the post-login phase.  The connection could have timed out while waiting for server to complete the login process and respond; Or it could have timed out while attempting to create multiple active connections.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=48; handshake=24; [Login] initialization=1; authentication=5; [Post-Login] complete=14000; 
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParserStateObject.ThrowExceptionAndWarning(Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error)
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByte(Byte& value)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.CompleteLogin(Boolean enlistOK)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:4b20c62f-719c-4f77-99a9-54b8b2b60132
Error Number:-2,State:0,Class:11 Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed during the post-login phase.  The connection could have timed out while waiting for server to complete the login process and respond; Or it could have timed out while attempting to create multiple active connections.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=48; handshake=24; [Login] initialization=1; authentication=5; [Post-Login] complete=14000; 
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParserStateObject.ThrowExceptionAndWarning(Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error)
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadByte(Byte& value)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.CompleteLogin(Boolean enlistOK)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:4b20c62f-719c-4f77-99a9-54b8b2b60132
Error Number:-2,State:0,Class:11
2025-05-13 15:33:36.1844 ERROR An error occurred using the connection to database 'TourBookingDB' on server '.\SQLEXPRESS'. 
2025-05-13 15:33:36.2392 ERROR An exception occurred while iterating over the results of a query for context type 'TourBookingWeb.Data.TourDBContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=50; handshake=14949; 
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParserStateObject.ThrowExceptionAndWarning(Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error)
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParser.ConsumePreLoginHandshake(SqlConnectionEncryptOption encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean& marsCapable, Boolean& fedAuthRequired, Boolean tlsFirst, String serverCert)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnectionString connectionOptions, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:b1975711-e2d9-4368-a4bb-b6ed13cb0478
Error Number:-2,State:0,Class:11 Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=50; handshake=14949; 
 ---> System.ComponentModel.Win32Exception (258): The wait operation timed out.
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParserStateObject.ThrowExceptionAndWarning(Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error)
   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   at Microsoft.Data.SqlClient.TdsParser.ConsumePreLoginHandshake(SqlConnectionEncryptOption encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean& marsCapable, Boolean& fedAuthRequired, Boolean tlsFirst, String serverCert)
   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, SqlConnectionString connectionOptions, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)
   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)
   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)
   at Microsoft.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:b1975711-e2d9-4368-a4bb-b6ed13cb0478
Error Number:-2,State:0,Class:11
2025-05-13 15:34:20.6744 INFO Executed DbCommand (96ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 15:34:20.7697 INFO Executed DbCommand (7ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 15:34:21.1957 INFO Now listening on: http://localhost:5062 
2025-05-13 15:34:21.2702 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 15:34:21.2702 INFO Hosting environment: Development 
2025-05-13 15:34:21.2702 INFO Content root path: C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 15:34:33.9509 INFO Executed DbCommand (20ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:34:34.0794 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:34:39.1129 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:34:39.1689 INFO Executed DbCommand (8ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:34:39.1960 INFO Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:34:39.3308 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:34:39.3615 INFO Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:34:39.3772 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:34:41.1441 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:34:41.1599 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:34:41.1663 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:34:41.6142 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:34:41.6190 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:34:41.6190 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:34:43.1861 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:34:43.2010 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:34:43.2010 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:34:47.4149 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:34:47.4149 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:34:47.4149 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:35:00.5589 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:35:00.5589 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:35:00.5589 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:35:01.2456 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:35:01.2456 INFO Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:35:01.2456 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:35:08.0997 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:35:08.1241 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 15:35:08.1347 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:35:08.1347 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:35:08.6770 INFO Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:35:08.8370 INFO Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:35:11.7716 INFO Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:35:11.7886 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:35:28.0418 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 15:35:28.0604 INFO Executed DbCommand (5ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:35:28.0604 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:35:33.1245 INFO Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:35:33.1245 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:35:47.6555 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:35:47.6715 INFO Executed DbCommand (4ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__model_TourId_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:35:47.6819 INFO Executed DbCommand (2ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:35:47.6819 INFO Executed DbCommand (1ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:35:47.6819 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:35:47.6819 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:35:47.6819 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:35:47.7836 INFO Executed DbCommand (12ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [TourSchedules] SET [RemainingSlot] = @p0
OUTPUT 1
WHERE [TourScheduleId] = @p1; 
2025-05-13 15:35:47.7953 INFO Cập nhật tour ID 36: Tour Ai Cập 7N6Đ – Cairo – Luxor 
2025-05-13 15:35:47.8119 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:35:47.8119 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:35:47.8119 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:35:47.8709 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:35:47.8709 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:35:47.8851 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:35:49.8321 INFO Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:35:49.8369 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:35:53.7436 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:35:53.7436 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:35:57.5972 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:35:57.5972 INFO Executed DbCommand (3ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__model_TourId_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:35:57.6028 INFO Executed DbCommand (1ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:35:57.6028 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:35:57.6028 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:35:57.6028 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:35:57.6028 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:35:57.6274 INFO Executed DbCommand (4ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p3='?' (DbType = Int32), @p2='?' (DbType = Boolean)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [TourSchedules] SET [IsDeleted] = @p0
OUTPUT 1
WHERE [TourScheduleId] = @p1;
UPDATE [TourSchedules] SET [IsDeleted] = @p2
OUTPUT 1
WHERE [TourScheduleId] = @p3; 
2025-05-13 15:35:57.6335 INFO Cập nhật tour ID 36: Tour Ai Cập 7N6Đ – Cairo – Luxor 
2025-05-13 15:35:57.6335 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:35:57.6335 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:35:57.6335 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:35:57.6914 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:35:57.6958 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:35:57.6958 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:35:59.1133 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:35:59.1201 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 15:36:03.4228 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:36:03.4228 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:36:09.5195 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:36:09.5195 WARN Dữ liệu tour không hợp lệ khi cập nhật. 
2025-05-13 15:36:09.7284 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The type arguments for method 'System.Text.Json.JsonSerializer.Serialize<TValue>(TValue, System.Text.Json.JsonSerializerOptions)' cannot be inferred from the usage. Try specifying the type arguments explicitly.
   at CallSite.Target(Closure, CallSite, Type, Object)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute2[T0,T1,TRet](CallSite site, T0 arg0, T1 arg1)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:36:31.9920 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:36:31.9920 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:36:35.1457 INFO Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:36:35.1457 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:36:37.5948 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:36:37.5948 WARN Dữ liệu tour không hợp lệ khi cập nhật. 
2025-05-13 15:36:37.6755 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The type arguments for method 'System.Text.Json.JsonSerializer.Serialize<TValue>(TValue, System.Text.Json.JsonSerializerOptions)' cannot be inferred from the usage. Try specifying the type arguments explicitly.
   at CallSite.Target(Closure, CallSite, Type, Object)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute2[T0,T1,TRet](CallSite site, T0 arg0, T1 arg1)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:36:38.7522 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:36:38.7522 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:37:22.8038 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:37:22.8058 WARN Dữ liệu tour không hợp lệ khi cập nhật. 
2025-05-13 15:37:22.8806 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The type arguments for method 'System.Text.Json.JsonSerializer.Serialize<TValue>(TValue, System.Text.Json.JsonSerializerOptions)' cannot be inferred from the usage. Try specifying the type arguments explicitly.
   at CallSite.Target(Closure, CallSite, Type, Object)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute2[T0,T1,TRet](CallSite site, T0 arg0, T1 arg1)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:37:38.6184 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:37:38.6184 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:38:01.2924 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:38:01.2924 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:38:01.2924 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:38:01.3538 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:38:01.3538 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:38:01.3688 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:38:02.9761 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:40:29.5970 INFO Executed DbCommand (79ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 15:40:29.6945 INFO Executed DbCommand (9ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 15:40:30.0728 INFO Now listening on: http://localhost:5062 
2025-05-13 15:40:30.1353 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 15:40:30.1353 INFO Hosting environment: Development 
2025-05-13 15:40:30.1353 INFO Content root path: C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 15:40:34.6922 INFO Executed DbCommand (12ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:40:36.7940 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:40:36.8545 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:40:36.8816 INFO Executed DbCommand (10ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:40:37.0357 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:40:37.1042 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:40:37.1539 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:40:38.4871 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:40:38.4964 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:40:43.3514 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:40:43.3514 WARN Dữ liệu tour không hợp lệ khi cập nhật. 
2025-05-13 15:40:43.5150 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The type arguments for method 'System.Text.Json.JsonSerializer.Serialize<TValue>(TValue, System.Text.Json.JsonSerializerOptions)' cannot be inferred from the usage. Try specifying the type arguments explicitly.
   at CallSite.Target(Closure, CallSite, Type, Object)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute2[T0,T1,TRet](CallSite site, T0 arg0, T1 arg1)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:40:54.0711 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:40:54.0711 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:41:00.3058 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:41:00.3058 WARN Dữ liệu tour không hợp lệ khi cập nhật. 
2025-05-13 15:41:00.3644 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The type arguments for method 'System.Text.Json.JsonSerializer.Serialize<TValue>(TValue, System.Text.Json.JsonSerializerOptions)' cannot be inferred from the usage. Try specifying the type arguments explicitly.
   at CallSite.Target(Closure, CallSite, Type, Object)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute2[T0,T1,TRet](CallSite site, T0 arg0, T1 arg1)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:41:01.7285 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:41:01.7285 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:41:04.2241 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:41:04.2275 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:41:13.4269 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:41:13.4459 INFO Executed DbCommand (4ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__model_TourId_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:41:13.4459 INFO Executed DbCommand (2ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:41:13.4459 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:41:13.4459 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:41:13.4459 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:41:13.4459 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:41:13.5851 INFO Executed DbCommand (20ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [TourSchedules] ([DepartureDate], [IsDeleted], [RemainingSlot], [ReturnDate], [TourId])
OUTPUT INSERTED.[TourScheduleId]
VALUES (@p0, @p1, @p2, @p3, @p4); 
2025-05-13 15:41:13.5990 INFO Cập nhật tour ID 33: Tour Pháp 7N6Đ – Paris – Versailles 
2025-05-13 15:41:13.6093 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:41:13.6093 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:41:13.6093 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:41:13.6659 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:41:13.6659 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:41:13.6816 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:41:15.7839 INFO Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:41:15.7839 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:41:19.5639 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:41:19.5639 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:41:19.5724 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:41:19.6188 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:41:19.6188 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:41:19.6188 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:41:24.3894 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:41:24.3894 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:41:26.9428 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:41:26.9457 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:41:26.9457 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:42:20.2510 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:42:20.2510 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:42:25.3927 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:42:25.3927 WARN Dữ liệu tour không hợp lệ khi cập nhật. 
2025-05-13 15:42:25.4742 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The type arguments for method 'System.Text.Json.JsonSerializer.Serialize<TValue>(TValue, System.Text.Json.JsonSerializerOptions)' cannot be inferred from the usage. Try specifying the type arguments explicitly.
   at CallSite.Target(Closure, CallSite, Type, Object)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute2[T0,T1,TRet](CallSite site, T0 arg0, T1 arg1)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:45:49.9757 INFO Executed DbCommand (82ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 15:45:50.0844 INFO Executed DbCommand (8ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 15:45:50.4973 INFO Now listening on: http://localhost:5062 
2025-05-13 15:45:50.5609 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 15:45:50.5609 INFO Hosting environment: Development 
2025-05-13 15:45:50.5609 INFO Content root path: C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 15:45:57.9222 INFO Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:45:58.0250 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:45:58.3236 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The best overloaded method match for 'System.Text.Json.JsonSerializer.Serialize<System.Collections.Generic.List<object>>(System.Collections.Generic.List<object>, System.Text.Json.JsonSerializerOptions)' has some invalid arguments
   at CallSite.Target(Closure, CallSite, Type, Object)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute2[T0,T1,TRet](CallSite site, T0 arg0, T1 arg1)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:46:00.7035 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:00.7391 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:46:00.7589 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:46:01.9019 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:01.9019 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:46:01.9019 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:46:02.0172 INFO Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:46:02.0449 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:46:02.0621 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:04.7776 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:46:04.7776 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:46:04.8673 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The best overloaded method match for 'System.Text.Json.JsonSerializer.Serialize<System.Collections.Generic.List<object>>(System.Collections.Generic.List<object>, System.Text.Json.JsonSerializerOptions)' has some invalid arguments
   at CallSite.Target(Closure, CallSite, Type, Object)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:46:07.7948 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:07.7948 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:46:07.7948 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:46:08.5984 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:08.6015 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:46:08.6015 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:46:08.6466 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:46:08.6533 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:46:08.6533 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:09.2282 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:09.2282 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:46:09.2282 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:46:09.2957 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:46:09.2957 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:46:09.3079 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:09.4073 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:09.4073 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:46:09.4206 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:46:09.4790 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:46:09.4790 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:46:09.5010 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:09.5737 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:09.5737 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:46:09.5737 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:46:09.6344 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:46:09.6344 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:46:09.6594 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:09.7445 INFO Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:09.7445 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:46:09.7575 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:46:09.8226 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:46:09.8226 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:46:09.8364 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:09.9147 INFO Executed DbCommand (16ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:09.9147 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:46:09.9378 INFO Executed DbCommand (10ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:46:10.0360 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:46:10.0434 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:46:10.0434 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:10.1210 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:10.1210 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:46:10.1345 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:46:10.2001 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:46:10.2001 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:46:10.2196 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:10.3462 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:10.3462 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:46:10.3537 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:46:10.4054 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:46:10.4054 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:46:10.4205 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:10.4996 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:10.4996 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:46:10.5121 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:46:10.5602 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:46:10.5602 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:46:10.5794 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:11.9661 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:46:11.9661 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:46:12.0455 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The best overloaded method match for 'System.Text.Json.JsonSerializer.Serialize<System.Collections.Generic.List<object>>(System.Collections.Generic.List<object>, System.Text.Json.JsonSerializerOptions)' has some invalid arguments
   at CallSite.Target(Closure, CallSite, Type, Object)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:46:23.8954 INFO Executed DbCommand (17ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:23.8997 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:46:23.8997 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:46:37.2849 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 15:46:37.4240 INFO Executed DbCommand (10ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 15:46:37.4539 INFO Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 15:46:37.4539 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 15:46:37.4728 INFO Executed DbCommand (5ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 15:46:37.4832 INFO Executed DbCommand (3ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 15:46:37.4832 INFO Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 15:46:37.4927 INFO Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 15:46:37.4927 INFO Executed DbCommand (3ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 15:46:37.4927 INFO Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 15:46:37.5393 INFO Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 15:46:37.5393 WARN admin 
2025-05-13 15:46:41.2416 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:41.2416 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:46:41.2416 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:46:41.2981 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:46:41.3069 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:46:41.3069 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:46:42.4206 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:46:42.4206 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:46:42.4923 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The best overloaded method match for 'System.Text.Json.JsonSerializer.Serialize<System.Collections.Generic.List<object>>(System.Collections.Generic.List<object>, System.Text.Json.JsonSerializerOptions)' has some invalid arguments
   at CallSite.Target(Closure, CallSite, Type, Object)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:51:29.4833 INFO Executed DbCommand (104ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 15:51:29.5786 INFO Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 15:51:29.9676 INFO Now listening on: http://localhost:5062 
2025-05-13 15:51:30.0236 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 15:51:30.0236 INFO Hosting environment: Development 
2025-05-13 15:51:30.0236 INFO Content root path: C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 15:51:33.2546 INFO Executed DbCommand (31ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:51:33.4070 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:51:38.7650 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:51:38.7650 WARN Dữ liệu tour không hợp lệ khi cập nhật. 
2025-05-13 15:51:38.9455 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The type arguments for method 'System.Text.Json.JsonSerializer.Serialize<TValue>(TValue, System.Text.Json.JsonSerializerOptions)' cannot be inferred from the usage. Try specifying the type arguments explicitly.
   at CallSite.Target(Closure, CallSite, Type, Object)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute2[T0,T1,TRet](CallSite site, T0 arg0, T1 arg1)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:51:40.9898 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:51:40.9942 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:51:46.5512 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:51:46.5512 WARN Dữ liệu tour không hợp lệ khi cập nhật. 
2025-05-13 15:51:46.6098 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The type arguments for method 'System.Text.Json.JsonSerializer.Serialize<TValue>(TValue, System.Text.Json.JsonSerializerOptions)' cannot be inferred from the usage. Try specifying the type arguments explicitly.
   at CallSite.Target(Closure, CallSite, Type, Object)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute2[T0,T1,TRet](CallSite site, T0 arg0, T1 arg1)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:51:48.2736 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:51:48.2736 INFO Executed DbCommand (0ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:51:51.7025 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:51:51.7025 WARN Dữ liệu tour không hợp lệ khi cập nhật. 
2025-05-13 15:51:51.7556 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The type arguments for method 'System.Text.Json.JsonSerializer.Serialize<TValue>(TValue, System.Text.Json.JsonSerializerOptions)' cannot be inferred from the usage. Try specifying the type arguments explicitly.
   at CallSite.Target(Closure, CallSite, Type, Object)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute2[T0,T1,TRet](CallSite site, T0 arg0, T1 arg1)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:51:54.3257 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:51:54.3257 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:52:02.1133 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:52:02.1334 INFO Executed DbCommand (5ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__model_TourId_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:52:02.1485 INFO Executed DbCommand (5ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:52:02.1485 INFO Executed DbCommand (1ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:52:02.1485 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:52:02.1485 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:52:02.1485 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:52:02.1875 INFO Cập nhật tour ID 36: Tour Ai Cập 7N6Đ – Cairo – Luxor 
2025-05-13 15:52:02.2194 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:52:02.2602 INFO Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:52:02.2871 INFO Executed DbCommand (12ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:52:02.3902 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:52:02.4267 INFO Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:52:02.4358 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:52:04.8776 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:52:04.8776 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:52:06.9024 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:52:06.9024 INFO Executed DbCommand (4ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__model_TourId_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:52:06.9024 INFO Executed DbCommand (1ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:52:06.9024 INFO Executed DbCommand (1ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:52:06.9141 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:52:06.9141 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:52:06.9141 INFO Executed DbCommand (0ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [t].[TourScheduleId], [t].[DepartureDate], [t].[IsDeleted], [t].[RemainingSlot], [t].[ReturnDate], [t].[TourId]
FROM [TourSchedules] AS [t]
WHERE [t].[TourScheduleId] = @__scheduleId_0 
2025-05-13 15:52:06.9141 INFO Cập nhật tour ID 34: Tour Đức – Hà Lan 7N6Đ – Frankfurt – Amsterdam 
2025-05-13 15:52:06.9141 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:52:06.9319 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:52:06.9319 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:52:06.9844 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:52:06.9844 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:52:06.9986 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:52:08.9576 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:52:08.9620 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:52:12.2824 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:52:12.2824 WARN Dữ liệu tour không hợp lệ khi cập nhật. 
2025-05-13 15:52:12.3400 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The type arguments for method 'System.Text.Json.JsonSerializer.Serialize<TValue>(TValue, System.Text.Json.JsonSerializerOptions)' cannot be inferred from the usage. Try specifying the type arguments explicitly.
   at CallSite.Target(Closure, CallSite, Type, Object)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute2[T0,T1,TRet](CallSite site, T0 arg0, T1 arg1)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:52:19.8592 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:52:19.8592 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:52:22.0584 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:52:22.0584 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:52:22.0584 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:52:22.1109 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:52:22.1109 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:52:22.1216 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:52:22.9029 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:52:22.9152 INFO Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:52:28.4388 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:52:28.4388 WARN Dữ liệu tour không hợp lệ khi cập nhật. 
2025-05-13 15:52:28.4971 ERROR An unhandled exception has occurred while executing the request. Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: The type arguments for method 'System.Text.Json.JsonSerializer.Serialize<TValue>(TValue, System.Text.Json.JsonSerializerOptions)' cannot be inferred from the usage. Try specifying the type arguments explicitly.
   at CallSite.Target(Closure, CallSite, Type, Object)
   at System.Dynamic.UpdateDelegates.UpdateAndExecute2[T0,T1,TRet](CallSite site, T0 arg0, T1 arg1)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Tour_Edit.<ExecuteAsync>b__27_2()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.<ExecuteAsync>b__17_1() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Areas\Admin\Views\Shared\_AdminLayout.cshtml:line 66
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCoreGeneratedDocument.Areas_Admin_Views_Shared__AdminLayout.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at TourBookingWeb.Program.<>c.<<Main>b__0_7>d.MoveNext() in C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb\Program.cs:line 143
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-13 15:52:29.7174 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:52:29.7174 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:55:16.5841 INFO Executed DbCommand (119ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 15:55:16.7056 INFO Executed DbCommand (9ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 15:55:17.1819 INFO Now listening on: http://localhost:5062 
2025-05-13 15:55:17.2341 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 15:55:17.2341 INFO Hosting environment: Development 
2025-05-13 15:55:17.2341 INFO Content root path: C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 15:55:22.3528 INFO Executed DbCommand (13ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:55:22.4485 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:55:26.2796 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:55:26.2886 WARN Dữ liệu tour không hợp lệ khi cập nhật. 
2025-05-13 15:55:46.9205 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:55:46.9205 WARN Dữ liệu tour không hợp lệ khi cập nhật. 
2025-05-13 15:56:06.0546 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:56:06.0766 INFO Executed DbCommand (4ms) [Parameters=[@__model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__model_TourId_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:56:06.1927 INFO Executed DbCommand (23ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [TourSchedules] ([DepartureDate], [IsDeleted], [RemainingSlot], [ReturnDate], [TourId])
OUTPUT INSERTED.[TourScheduleId]
VALUES (@p0, @p1, @p2, @p3, @p4); 
2025-05-13 15:56:06.2103 INFO Cập nhật tour ID 36: Tour Ai Cập 7N6Đ – Cairo – Luxor 
2025-05-13 15:56:06.2391 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:56:06.2851 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:56:06.3104 INFO Executed DbCommand (11ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:56:06.4291 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:56:06.4637 INFO Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:56:06.4831 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:56:07.9916 INFO Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 15:56:07.9970 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c] 
2025-05-13 15:56:17.9864 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:56:17.9954 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:56:17.9954 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:56:18.0186 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:56:18.0186 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:56:18.0235 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:56:18.0697 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:56:18.0774 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:56:18.0774 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:56:19.4887 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:56:19.4925 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:56:19.4925 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:56:19.5404 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:56:19.5404 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:56:19.5569 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:56:21.6888 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:56:21.7045 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:56:21.7045 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:56:22.0888 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:56:22.0888 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:56:22.0888 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:56:24.0626 INFO Executed DbCommand (10ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:56:24.0967 INFO Executed DbCommand (25ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:56:24.1255 INFO Executed DbCommand (14ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:56:24.1484 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:56:24.1660 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[TourId] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[TourId] DESC 
2025-05-13 15:56:24.1660 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[DayNumber] = 0 
2025-05-13 15:56:32.8862 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:56:32.9117 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 15:56:32.9191 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 15:56:32.9191 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 15:56:33.3966 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 15:56:33.5351 INFO Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:56:37.6594 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 15:56:37.6788 INFO Executed DbCommand (9ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 15:56:37.6843 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 15:56:37.6843 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:08:20.9946 INFO Executed DbCommand (79ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 16:08:21.0845 INFO Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 16:08:21.5235 INFO Now listening on: http://localhost:5062 
2025-05-13 16:08:21.5826 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 16:08:21.5826 INFO Hosting environment: Development 
2025-05-13 16:08:21.5826 INFO Content root path: C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 16:08:28.7787 INFO Executed DbCommand (36ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:08:28.8781 INFO Executed DbCommand (5ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:08:31.5627 INFO Executed DbCommand (12ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:08:31.6129 INFO Executed DbCommand (26ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:08:31.6645 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:08:31.7040 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:08:32.1174 INFO Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:08:32.2434 INFO Executed DbCommand (50ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:08:36.7121 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:08:36.7121 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:08:43.7041 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:08:43.7246 INFO Executed DbCommand (10ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:08:43.7328 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:08:43.7328 INFO Executed DbCommand (3ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:08:47.8553 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:08:47.8553 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:08:47.8751 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:08:47.8751 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:08:50.3873 INFO Executed DbCommand (18ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 16:08:50.4254 INFO Executed DbCommand (21ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:08:51.6719 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:08:51.6719 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:08:53.0174 INFO Executed DbCommand (6ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 16:08:53.0393 INFO Executed DbCommand (8ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:08:53.0393 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:08:53.0393 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:08:53.1205 INFO Executed DbCommand (11ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 16:08:53.1461 INFO Executed DbCommand (21ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:08:54.8526 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:08:54.8526 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:09:10.8038 INFO Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:09:10.8111 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:09:14.9747 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:09:14.9797 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:09:17.0679 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:09:17.0770 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:09:17.0866 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:09:17.0866 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:09:17.1695 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:09:17.1929 INFO Executed DbCommand (18ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:09:21.3870 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:09:21.4126 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:09:22.1881 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:09:22.1991 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:09:22.9067 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:09:22.9220 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:10:43.8186 INFO Executed DbCommand (50ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 16:10:43.9087 INFO Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 16:10:44.3068 INFO Now listening on: http://localhost:5062 
2025-05-13 16:10:44.3635 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 16:10:44.3635 INFO Hosting environment: Development 
2025-05-13 16:10:44.3635 INFO Content root path: C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 16:10:50.8299 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:10:50.9108 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:11:00.1196 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:11:00.1526 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:11:00.2123 INFO Executed DbCommand (14ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:11:00.2655 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:11:00.7225 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:11:00.8162 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:11:37.7700 INFO Executed DbCommand (51ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 16:11:37.8717 INFO Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 16:11:38.3190 INFO Now listening on: http://localhost:5062 
2025-05-13 16:11:38.3856 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 16:11:38.3856 INFO Hosting environment: Development 
2025-05-13 16:11:38.3856 INFO Content root path: C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 16:12:00.8197 INFO Executed DbCommand (12ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:12:00.9941 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:12:01.1416 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:12:01.1844 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:12:01.7884 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:12:01.8557 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:12:06.0737 INFO Executed DbCommand (11ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 16:12:06.0955 INFO Executed DbCommand (10ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:12:07.3963 INFO Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:12:07.4406 INFO Executed DbCommand (7ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:12:15.2544 INFO Executed DbCommand (5ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 16:12:15.2766 INFO Executed DbCommand (6ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:12:15.2766 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:12:15.2766 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:12:15.7503 INFO Executed DbCommand (8ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 16:12:15.7753 INFO Executed DbCommand (19ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:12:18.4459 INFO Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:12:18.4459 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:12:18.4745 INFO Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:12:18.4768 INFO Executed DbCommand (0ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:12:34.8159 INFO Executed DbCommand (4ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 16:12:34.8254 INFO Executed DbCommand (6ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:12:34.8254 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:12:34.8254 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:12:35.1950 INFO Executed DbCommand (5ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 16:12:35.2153 INFO Executed DbCommand (18ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:12:36.4116 INFO Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:12:36.4181 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:12:43.6297 INFO Executed DbCommand (5ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 16:12:43.6410 INFO Executed DbCommand (8ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:12:43.6410 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:12:43.6410 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:12:43.6878 INFO Executed DbCommand (3ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 16:12:43.7057 INFO Executed DbCommand (15ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:12:49.0801 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:12:49.0921 INFO Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:12:51.0338 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:12:51.0499 INFO Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:12:51.8674 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:12:51.8674 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:12:55.2178 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:12:55.2287 INFO Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:12:57.9330 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:12:57.9330 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:12:59.3825 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:12:59.3881 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:12:59.3881 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:12:59.3881 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:12:59.4503 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:12:59.4722 INFO Executed DbCommand (18ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:13:03.4673 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:13:03.4768 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:13:05.1304 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:13:05.1383 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:13:07.1210 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:13:07.1210 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:13:07.1333 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:13:07.1333 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:13:07.4868 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:13:07.5038 INFO Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:13:13.4662 INFO Executed DbCommand (4ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 16:13:13.4878 INFO Executed DbCommand (8ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:13:14.4284 INFO Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:13:14.4348 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:13:18.6838 INFO Executed DbCommand (4ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 16:13:18.7016 INFO Executed DbCommand (5ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:13:18.7016 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:13:18.7016 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:13:18.7562 INFO Executed DbCommand (4ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 16:13:18.7756 INFO Executed DbCommand (17ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:13:25.1856 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:13:25.1856 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:13:35.4689 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:13:35.4784 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:13:36.6191 INFO Executed DbCommand (3ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:13:36.6353 INFO Executed DbCommand (7ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:13:36.6353 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:13:36.6353 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:13:40.8650 INFO Executed DbCommand (14ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:13:40.9060 INFO Executed DbCommand (36ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:13:46.9227 INFO Executed DbCommand (3ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:13:46.9471 INFO Executed DbCommand (8ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:13:46.9471 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:13:46.9629 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:13:47.2039 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:13:47.2190 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:13:53.4189 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:13:53.4297 INFO Executed DbCommand (8ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:13:53.4297 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:13:53.4297 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:13:56.6146 INFO Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:13:56.6227 INFO Executed DbCommand (5ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:14:00.8643 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:14:00.8711 INFO Executed DbCommand (5ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:14:00.8711 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:14:00.8711 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:14:00.9281 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:14:00.9543 INFO Executed DbCommand (23ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:14:07.0280 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:14:07.0280 INFO Executed DbCommand (7ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:14:07.0415 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:14:07.0415 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:14:09.6363 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:14:09.6363 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:14:13.0905 INFO Executed DbCommand (3ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:14:13.0905 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:14:13.0905 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:14:13.1010 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:14:13.1979 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:14:13.2180 INFO Executed DbCommand (17ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:14:19.4202 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:14:19.4202 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:14:22.1927 INFO Executed DbCommand (5ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 16:14:22.2065 INFO Executed DbCommand (12ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:14:22.9488 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:14:22.9488 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:14:31.2743 INFO Executed DbCommand (4ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 16:14:31.2743 INFO Executed DbCommand (5ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:14:31.2743 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:14:31.2743 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:14:31.3309 INFO Executed DbCommand (4ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 16:14:31.3478 INFO Executed DbCommand (15ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:14:40.6041 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:14:40.6041 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:14:42.2914 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:14:42.2914 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:14:48.1247 INFO Executed DbCommand (16ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0) 
2025-05-13 16:14:48.1429 INFO Executed DbCommand (9ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0)
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 16:14:48.1486 INFO Executed DbCommand (2ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0) 
2025-05-13 16:14:48.1486 INFO Executed DbCommand (2ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0)
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 16:14:49.6361 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:14:49.6361 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:14:52.0215 INFO Executed DbCommand (3ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0) 
2025-05-13 16:14:52.0460 INFO Executed DbCommand (11ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[AdultPrice], [t2].[Capacity], [t2].[CategoryId], [t2].[ChildPrice], [t2].[Description], [t2].[Destination], [t2].[Duration], [t2].[Itinerary], [t2].[Title], [t2].[Transport], [t1].[TourScheduleId], [t1].[DepartureDate], [t1].[IsDeleted], [t1].[RemainingSlot], [t1].[ReturnDate], [t1].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0)
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t2]
LEFT JOIN [TourSchedules] AS [t1] ON [t2].[TourId] = [t1].[TourId]
ORDER BY [t2].[Title], [t2].[TourId] 
2025-05-13 16:14:52.0460 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:14:52.0460 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:14:52.3984 INFO Executed DbCommand (3ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0) 
2025-05-13 16:14:52.4030 INFO Executed DbCommand (2ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0)
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 16:14:54.9340 INFO Executed DbCommand (8ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 16:14:54.9584 INFO Executed DbCommand (14ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 16:14:54.9636 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 16:14:54.9636 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 16:14:57.9765 INFO Executed DbCommand (3ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:14:57.9765 INFO Executed DbCommand (10ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:14:57.9931 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:14:57.9931 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:15:00.5191 INFO Executed DbCommand (3ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:15:00.5304 INFO Executed DbCommand (10ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:15:00.5304 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:15:00.5304 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:15:02.6933 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:15:02.6980 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:15:07.1426 INFO Executed DbCommand (5ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:15:07.1426 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:15:07.1532 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:15:07.1532 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:15:07.2017 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:15:07.2179 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:15:16.7319 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:15:16.7499 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:15:17.8097 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:15:17.8097 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:15:18.3302 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:15:18.3302 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:15:20.1063 INFO Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:15:20.1063 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:19:42.0496 INFO Executed DbCommand (74ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 16:19:42.1411 INFO Executed DbCommand (6ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 16:19:42.6546 INFO Now listening on: http://localhost:5062 
2025-05-13 16:19:42.7171 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 16:19:42.7171 INFO Hosting environment: Development 
2025-05-13 16:19:42.7171 INFO Content root path: C:\Users\PC\Downloads\52200146_52200157_52200318\TourBookingWeb 
2025-05-13 16:19:53.6474 INFO Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:19:53.7319 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:20:06.2916 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:20:06.2916 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:20:06.3218 INFO Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:20:06.3218 INFO Executed DbCommand (1ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:20:41.9905 INFO Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:20:41.9969 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:20:47.7766 INFO Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:20:47.8036 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:20:47.8559 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:20:47.8997 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:20:48.0769 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:20:48.1772 INFO Executed DbCommand (16ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:20:50.1577 INFO Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:20:50.1577 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:20:53.0071 INFO Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:20:53.0168 INFO Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:20:53.0236 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:20:53.0236 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:20:53.4648 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:20:53.4852 INFO Executed DbCommand (16ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:21:01.4885 INFO Executed DbCommand (9ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0) 
2025-05-13 16:21:01.5110 INFO Executed DbCommand (10ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0)
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 16:21:01.8225 INFO Executed DbCommand (2ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0) 
2025-05-13 16:21:01.8225 INFO Executed DbCommand (1ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0)
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 16:21:02.2517 INFO Executed DbCommand (9ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0) 
2025-05-13 16:21:02.2660 INFO Executed DbCommand (13ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0)
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 16:21:02.6985 INFO Executed DbCommand (6ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0) 
2025-05-13 16:21:02.7123 INFO Executed DbCommand (12ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0)
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 16:21:03.1163 INFO Executed DbCommand (8ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0) 
2025-05-13 16:21:03.1270 INFO Executed DbCommand (9ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0)
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 16:21:03.7733 INFO Executed DbCommand (7ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0) 
2025-05-13 16:21:03.7733 INFO Executed DbCommand (13ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0)
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 16:21:05.5066 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:21:05.5146 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:21:06.8680 INFO Executed DbCommand (8ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0) 
2025-05-13 16:21:06.8872 INFO Executed DbCommand (7ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[AdultPrice], [t2].[Capacity], [t2].[CategoryId], [t2].[ChildPrice], [t2].[Description], [t2].[Destination], [t2].[Duration], [t2].[Itinerary], [t2].[Title], [t2].[Transport], [t1].[TourScheduleId], [t1].[DepartureDate], [t1].[IsDeleted], [t1].[RemainingSlot], [t1].[ReturnDate], [t1].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0)
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t2]
LEFT JOIN [TourSchedules] AS [t1] ON [t2].[TourId] = [t1].[TourId]
ORDER BY [t2].[Title], [t2].[TourId] 
2025-05-13 16:21:06.8872 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:21:06.8872 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:21:07.3531 INFO Executed DbCommand (14ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0) 
2025-05-13 16:21:07.3852 INFO Executed DbCommand (29ms) [Parameters=[@__departureDate_Value_Date_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_0)
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 16:21:11.5453 INFO Executed DbCommand (8ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 16:21:11.5687 INFO Executed DbCommand (11ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 16:21:11.5744 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
    SELECT 1
    FROM [TourSchedules] AS [t0]
    WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1) 
2025-05-13 16:21:11.5744 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__departureDate_Value_Date_1='?' (DbType = DateTime2), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t2].[TourId], [t2].[Title], [t2].[Destination], [t2].[Duration], [t2].[Capacity], [t2].[AdultPrice], [t4].[DepartureDate], [t4].[TourScheduleId], [t2].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND EXISTS (
        SELECT 1
        FROM [TourSchedules] AS [t0]
        WHERE [t].[TourId] = [t0].[TourId] AND CONVERT(date, [t0].[DepartureDate]) = @__departureDate_Value_Date_1)
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t2]
LEFT JOIN (
    SELECT [t3].[DepartureDate], [t3].[TourScheduleId], [t3].[TourId]
    FROM (
        SELECT [t1].[DepartureDate], [t1].[TourScheduleId], [t1].[TourId], ROW_NUMBER() OVER(PARTITION BY [t1].[TourId] ORDER BY [t1].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t1]
        WHERE [t1].[IsDeleted] = CAST(0 AS bit)
    ) AS [t3]
    WHERE [t3].[row] <= 3
) AS [t4] ON [t2].[TourId] = [t4].[TourId]
ORDER BY [t2].[Title], [t2].[TourId], [t4].[TourId], [t4].[DepartureDate] 
2025-05-13 16:21:14.7236 INFO Executed DbCommand (3ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:21:14.7383 INFO Executed DbCommand (6ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:21:14.7434 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:21:14.7434 INFO Executed DbCommand (3ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:21:18.5487 INFO Executed DbCommand (5ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__destination_1_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND [t].[Destination] LIKE @__destination_1_contains ESCAPE N'\' 
2025-05-13 16:21:18.5708 INFO Executed DbCommand (9ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__destination_1_contains='?' (Size = 200), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND [t].[Destination] LIKE @__destination_1_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:21:20.9171 INFO Executed DbCommand (5ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 16:21:20.9354 INFO Executed DbCommand (7ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:21:20.9354 INFO Executed DbCommand (1ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 16:21:20.9354 INFO Executed DbCommand (2ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:21:24.2823 INFO Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:21:24.2891 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:21:26.0557 INFO Executed DbCommand (4ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 16:21:26.0752 INFO Executed DbCommand (5ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:21:26.0752 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:21:26.0752 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:21:26.1362 INFO Executed DbCommand (5ms) [Parameters=[@__destination_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\' 
2025-05-13 16:21:26.1628 INFO Executed DbCommand (21ms) [Parameters=[@__destination_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Destination] LIKE @__destination_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:21:31.1154 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__destination_1_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND [t].[Destination] LIKE @__destination_1_contains ESCAPE N'\' 
2025-05-13 16:21:31.1241 INFO Executed DbCommand (7ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__destination_1_contains='?' (Size = 200), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND [t].[Destination] LIKE @__destination_1_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:21:31.1241 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__destination_1_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 AND [t].[Destination] LIKE @__destination_1_contains ESCAPE N'\' 
2025-05-13 16:21:31.1328 INFO Executed DbCommand (1ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__destination_1_contains='?' (Size = 200), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0 AND [t].[Destination] LIKE @__destination_1_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:21:33.8967 INFO Executed DbCommand (2ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:21:33.9055 INFO Executed DbCommand (7ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:21:38.8105 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:21:38.8386 INFO Executed DbCommand (14ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:21:39.0918 INFO Executed DbCommand (3ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:21:39.1025 INFO Executed DbCommand (9ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:21:42.5993 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:21:42.6098 INFO Executed DbCommand (8ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:21:45.5277 INFO Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:21:45.5277 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:21:47.1957 INFO Executed DbCommand (4ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[CategoryId] = @__categoryId_0 
2025-05-13 16:21:47.2204 INFO Executed DbCommand (9ms) [Parameters=[@__categoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[CategoryId] = @__categoryId_0
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:21:47.2267 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:21:47.2267 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:21:47.5411 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:21:47.5766 INFO Executed DbCommand (31ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:22:13.5931 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:22:13.5931 INFO Executed DbCommand (3ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:22:44.4485 INFO Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:22:44.4651 INFO Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:22:44.4814 INFO Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:22:44.4929 INFO Executed DbCommand (10ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:22:45.1582 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:22:45.1728 INFO Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:22:46.6364 INFO Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:22:46.6364 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:22:53.6546 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:22:53.6546 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:22:58.8707 INFO Executed DbCommand (12ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 16:23:01.3806 INFO Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 16:23:01.4473 INFO Executed DbCommand (12ms) [Parameters=[@__user_UserId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [b].[BookingId], [b].[AdultQuantity], [b].[BookingDate], [b].[ChildQuantity], [b].[DepartureDate], [b].[PaymentMethod], [b].[SpecialRequest], [b].[TotalPrice], [b].[TourId], [b].[TourScheduleId], [b].[UserId], [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport], [t0].[TourScheduleId], [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM [Bookings] AS [b]
INNER JOIN [Tours] AS [t] ON [b].[TourId] = [t].[TourId]
LEFT JOIN [TourSchedules] AS [t0] ON [b].[TourScheduleId] = [t0].[TourScheduleId]
LEFT JOIN [Images] AS [i] ON [t].[TourId] = [i].[TourId]
WHERE [b].[UserId] = @__user_UserId_0
ORDER BY [b].[BookingDate] DESC, [b].[BookingId], [t].[TourId], [t0].[TourScheduleId] 
2025-05-13 16:23:09.9008 INFO Executed DbCommand (4ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:23:09.9008 INFO Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:23:09.9008 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:23:09.9157 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:23:10.1868 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:23:10.2009 INFO Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:23:40.5042 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:23:40.5271 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 16:23:46.5544 INFO Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:23:46.5574 INFO Executed DbCommand (2ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:24:07.6843 INFO Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 16:24:07.6843 INFO Executed DbCommand (4ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 16:24:10.3003 INFO Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:24:10.3068 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 16:24:10.3068 INFO Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 16:24:10.3068 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 16:24:10.3573 INFO Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 16:24:10.3686 INFO Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 17:45:14.5168 INFO Executed DbCommand (196ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 17:45:14.7561 INFO Executed DbCommand (18ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 17:45:14.9318 INFO Executed DbCommand (11ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0 
2025-05-13 17:45:15.0917 INFO Executed DbCommand (20ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 256), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 256), @p8='?' (Size = 256), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AspNetUsers] ([Id], [AccessFailedCount], [ConcurrencyStamp], [Email], [EmailConfirmed], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [SecurityStamp], [TwoFactorEnabled], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14); 
2025-05-13 17:45:15.1133 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0 
2025-05-13 17:45:15.1529 INFO Executed DbCommand (3ms) [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1 
2025-05-13 17:45:15.1529 INFO Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0 
2025-05-13 17:45:15.1727 INFO Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0 
2025-05-13 17:45:15.2168 INFO Executed DbCommand (18ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p16='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p17='?' (Size = 4000), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 256), @p9='?' (Size = 256), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p2, [ConcurrencyStamp] = @p3, [Email] = @p4, [EmailConfirmed] = @p5, [LockoutEnabled] = @p6, [LockoutEnd] = @p7, [NormalizedEmail] = @p8, [NormalizedUserName] = @p9, [PasswordHash] = @p10, [PhoneNumber] = @p11, [PhoneNumberConfirmed] = @p12, [SecurityStamp] = @p13, [TwoFactorEnabled] = @p14, [UserName] = @p15
OUTPUT 1
WHERE [Id] = @p16 AND [ConcurrencyStamp] = @p17; 
2025-05-13 17:45:15.6552 INFO Now listening on: http://localhost:5062 
2025-05-13 17:45:15.7236 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 17:45:15.7236 INFO Hosting environment: Development 
2025-05-13 17:45:15.7236 INFO Content root path: E:\6. Đại học HKII - Năm 3\Công nghệ .Net\Cuối kì\TourBookingWeb 
2025-05-13 17:45:24.5138 INFO Executed DbCommand (14ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 17:45:24.6749 INFO Executed DbCommand (44ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
FROM (
    SELECT [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN [TourSchedules] AS [t0] ON [t1].[TourId] = [t0].[TourId]
ORDER BY [t1].[Title], [t1].[TourId] 
2025-05-13 17:45:24.8446 INFO Executed DbCommand (8ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT CONVERT(varchar(11), [c].[CategoryId]) AS [Value], [c].[CategoryName] AS [Text]
FROM [Categories] AS [c] 
2025-05-13 17:45:24.8941 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [t0].[Destination]
FROM (
    SELECT DISTINCT [t].[Destination]
    FROM [Tours] AS [t]
) AS [t0]
ORDER BY [t0].[Destination] 
2025-05-13 17:45:25.5091 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t] 
2025-05-13 17:45:25.6397 INFO Executed DbCommand (57ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    ORDER BY [t].[Title]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 17:45:31.1141 INFO Executed DbCommand (10ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 17:45:31.1470 INFO Executed DbCommand (17ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 17:45:33.3014 INFO Executed DbCommand (5ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 17:45:33.3175 INFO Executed DbCommand (13ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 17:45:33.7410 INFO Executed DbCommand (5ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 17:45:33.7561 INFO Executed DbCommand (13ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 17:45:34.3366 INFO Executed DbCommand (5ms) [Parameters=[@__keyword_0_contains='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Tours] AS [t]
WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\' 
2025-05-13 17:45:34.3532 INFO Executed DbCommand (14ms) [Parameters=[@__keyword_0_contains='?' (Size = 200), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[Title], [t1].[Destination], [t1].[Duration], [t1].[Capacity], [t1].[AdultPrice], [t3].[DepartureDate], [t3].[TourScheduleId], [t1].[c]
FROM (
    SELECT [t].[TourId], [t].[Title], [t].[Destination], [t].[Duration], [t].[Capacity], [t].[AdultPrice], COALESCE((
        SELECT TOP(1) [i].[Url]
        FROM [Images] AS [i]
        WHERE [i].[TourId] = [t].[TourId] AND [i].[DayNumber] = 0), N'assets/images/no-image.jpg') AS [c]
    FROM [Tours] AS [t]
    WHERE [t].[Title] LIKE @__keyword_0_contains ESCAPE N'\'
    ORDER BY [t].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t1]
LEFT JOIN (
    SELECT [t2].[DepartureDate], [t2].[TourScheduleId], [t2].[TourId]
    FROM (
        SELECT [t0].[DepartureDate], [t0].[TourScheduleId], [t0].[TourId], ROW_NUMBER() OVER(PARTITION BY [t0].[TourId] ORDER BY [t0].[DepartureDate]) AS [row]
        FROM [TourSchedules] AS [t0]
        WHERE [t0].[IsDeleted] = CAST(0 AS bit)
    ) AS [t2]
    WHERE [t2].[row] <= 3
) AS [t3] ON [t1].[TourId] = [t3].[TourId]
ORDER BY [t1].[Title], [t1].[TourId], [t3].[TourId], [t3].[DepartureDate] 
2025-05-13 17:45:36.0564 INFO Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [t1].[TourId], [t1].[AdultPrice], [t1].[Capacity], [t1].[CategoryId], [t1].[ChildPrice], [t1].[Description], [t1].[Destination], [t1].[Duration], [t1].[Itinerary], [t1].[Title], [t1].[Transport], [t2].[TourScheduleId], [t2].[DepartureDate], [t2].[IsDeleted], [t2].[RemainingSlot], [t2].[ReturnDate], [t2].[TourId]
FROM (
    SELECT TOP(1) [t].[TourId], [t].[AdultPrice], [t].[Capacity], [t].[CategoryId], [t].[ChildPrice], [t].[Description], [t].[Destination], [t].[Duration], [t].[Itinerary], [t].[Title], [t].[Transport]
    FROM [Tours] AS [t]
    WHERE [t].[TourId] = @__id_0
) AS [t1]
LEFT JOIN (
    SELECT [t0].[TourScheduleId], [t0].[DepartureDate], [t0].[IsDeleted], [t0].[RemainingSlot], [t0].[ReturnDate], [t0].[TourId]
    FROM [TourSchedules] AS [t0]
    WHERE [t0].[IsDeleted] = CAST(0 AS bit)
) AS [t2] ON [t1].[TourId] = [t2].[TourId]
ORDER BY [t1].[TourId] 
2025-05-13 17:45:36.1034 INFO Executed DbCommand (6ms) [Parameters=[@__Model_TourId_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [i].[ImageId], [i].[DayNumber], [i].[Description], [i].[TourId], [i].[Url]
FROM [Images] AS [i]
WHERE [i].[TourId] = @__Model_TourId_0 
2025-05-13 22:34:21.9773 INFO Executed DbCommand (117ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 22:34:22.0778 INFO Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 22:34:22.4869 INFO Now listening on: http://localhost:5062 
2025-05-13 22:34:22.5595 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 22:34:22.5595 INFO Hosting environment: Development 
2025-05-13 22:34:22.5595 INFO Content root path: E:\6. Đại học HKII - Năm 3\Công nghệ .Net\Cuối kì\TourBookingWeb 
2025-05-13 22:34:40.3583 INFO Executed DbCommand (11ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 22:34:54.3499 INFO Executed DbCommand (7ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 22:34:54.6057 INFO Executed DbCommand (6ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 22:34:54.6404 INFO Executed DbCommand (11ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 22:34:54.6404 INFO Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 22:34:54.6561 INFO Executed DbCommand (3ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 22:34:54.6687 INFO Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 22:34:54.6687 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 22:34:54.6687 INFO Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 22:34:54.6687 INFO Executed DbCommand (1ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 22:34:54.6802 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 22:34:54.8586 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 22:34:54.8586 WARN admin 
2025-05-13 22:55:46.7505 INFO Executed DbCommand (89ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 22:55:46.8652 INFO Executed DbCommand (8ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 22:55:47.2400 INFO Now listening on: http://localhost:5062 
2025-05-13 22:55:47.3137 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 22:55:47.3137 INFO Hosting environment: Development 
2025-05-13 22:55:47.3137 INFO Content root path: E:\6. Đại học HKII - Năm 3\Công nghệ .Net\Cuối kì\TourBookingWeb 
2025-05-13 22:56:12.3875 INFO Executed DbCommand (6ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 22:56:12.4157 INFO Executed DbCommand (11ms) [Parameters=[@__model_Email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__model_Email_0 
2025-05-13 22:56:12.5581 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0 
2025-05-13 22:56:12.8616 INFO Executed DbCommand (178ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 256), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTimeOffset), @p7='?' (Size = 256), @p8='?' (Size = 256), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = Boolean), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (Size = 256), @p15='?' (Size = 200), @p16='?' (Size = 200), @p17='?' (Size = 200), @p18='?' (Size = 200), @p19='?' (Size = 200), @p20='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUsers] ([Id], [AccessFailedCount], [ConcurrencyStamp], [Email], [EmailConfirmed], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [SecurityStamp], [TwoFactorEnabled], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
INSERT INTO [Users] ([Address], [Email], [FullName], [Password], [Phone], [Role])
OUTPUT INSERTED.[UserId]
VALUES (@p15, @p16, @p17, @p18, @p19, @p20); 
2025-05-13 22:56:16.7162 INFO Đăng ký thành công cho ptduong394@gmail.com, đã gửi mã OTP 
2025-05-13 22:56:37.2607 INFO Executed DbCommand (12ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 22:56:37.2607 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0 
2025-05-13 22:56:37.3051 INFO Executed DbCommand (25ms) [Parameters=[@p14='?' (Size = 450), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p15='?' (Size = 4000), @p2='?' (Size = 256), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTimeOffset), @p6='?' (Size = 256), @p7='?' (Size = 256), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (DbType = Boolean), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [Email] = @p2, [EmailConfirmed] = @p3, [LockoutEnabled] = @p4, [LockoutEnd] = @p5, [NormalizedEmail] = @p6, [NormalizedUserName] = @p7, [PasswordHash] = @p8, [PhoneNumber] = @p9, [PhoneNumberConfirmed] = @p10, [SecurityStamp] = @p11, [TwoFactorEnabled] = @p12, [UserName] = @p13
OUTPUT 1
WHERE [Id] = @p14 AND [ConcurrencyStamp] = @p15; 
2025-05-13 22:56:44.8992 INFO Executed DbCommand (9ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 22:56:45.0608 INFO Executed DbCommand (13ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 22:56:45.1110 INFO Executed DbCommand (11ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 22:56:45.1369 INFO Executed DbCommand (5ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 22:56:45.1369 INFO Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 22:56:45.1619 INFO Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 22:56:45.2652 INFO Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 22:56:45.2652 WARN  
2025-05-13 22:57:34.6834 INFO Executed DbCommand (6ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 22:57:42.3147 INFO Executed DbCommand (6ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 23:42:39.5804 INFO Executed DbCommand (81ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 23:42:39.6776 INFO Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 23:42:40.0245 INFO Now listening on: http://localhost:5062 
2025-05-13 23:42:40.0844 INFO Application started. Press Ctrl+C to shut down. 
2025-05-13 23:42:40.0844 INFO Hosting environment: Development 
2025-05-13 23:42:40.0844 INFO Content root path: E:\6. Đại học HKII - Năm 3\Công nghệ .Net\Cuối kì\TourBookingWeb 
2025-05-13 23:42:54.6922 INFO Executed DbCommand (12ms) [Parameters=[@__email_0='?' (Size = 200)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[Address], [u].[Email], [u].[FullName], [u].[Password], [u].[Phone], [u].[Role]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0 
2025-05-13 23:43:07.3885 INFO Executed DbCommand (8ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0 
2025-05-13 23:43:07.5234 INFO Executed DbCommand (5ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 23:43:07.5644 INFO Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 23:43:07.5728 INFO Executed DbCommand (4ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 23:43:07.5728 INFO Executed DbCommand (5ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 23:43:07.5922 INFO Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0 
2025-05-13 23:43:07.5922 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 23:43:07.5922 INFO Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0 
2025-05-13 23:43:07.5922 INFO Executed DbCommand (1ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0 
2025-05-13 23:43:07.6039 INFO Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 23:43:07.6039 INFO Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0 
2025-05-13 23:43:07.6212 WARN admin 
2025-05-13 23:43:09.2422 INFO Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c] 
2025-05-13 23:43:09.2603 INFO Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c]
ORDER BY [c].[CategoryId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY 
2025-05-13 23:43:11.3187 INFO Executed DbCommand (12ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tours] AS [t]
        WHERE [t].[CategoryId] = @__id_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END 
2025-05-13 23:43:11.3253 WARN Không thể xóa loại tour ID 1 vì đang được sử dụng 
2025-05-13 23:43:11.3897 INFO Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c] 
2025-05-13 23:43:11.3897 INFO Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c]
ORDER BY [c].[CategoryId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY 
2025-05-13 23:43:16.0797 INFO Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Tours] AS [t]
        WHERE [t].[CategoryId] = @__id_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END 
2025-05-13 23:43:16.0797 WARN Không thể xóa loại tour ID 2 vì đang được sử dụng 
2025-05-13 23:43:16.1442 INFO Executed DbCommand (6ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c] 
2025-05-13 23:43:16.1507 INFO Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT [c].[CategoryId], [c].[CategoryName]
FROM [Categories] AS [c]
ORDER BY [c].[CategoryId]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY 
